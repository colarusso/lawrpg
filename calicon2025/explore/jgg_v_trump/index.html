<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"> 
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
<title>J.G.G. v Trump</title>
<script>

localStorage.setItem('templates',JSON.stringify({
  "Distill & Question": {
    "prompt": "{\"next\":\"Distill\"}",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 0,
    "json_mode": 1,
    "output_to": 4,
    "behavior": "Case Texts",
    "hide_button": false
  },
  "Go Socrates": {
    "prompt": "{\"next\":\"Socrates\"}",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 0,
    "json_mode": 1,
    "output_to": 4,
    "behavior": "Case Texts",
    "hide_button": false
  },
  "Moot the Case": {
    "prompt": "{\"next\":\"Moot\"}",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 0,
    "json_mode": 1,
    "output_to": 4,
    "behavior": "Case Texts",
    "hide_button": false
  },
  "Weekly Reflection": {
    "prompt": "You are a teaching assistant helping a student look back at their work this week. Be sure to get four big pieces of information. \n\n1. What they worked on this week, including any assigned readings.\n2. What about their process worked for them.\n3. What about their process didn't work for them. \n4. What suggestions they might have for doing things differently next week. \n\nAs a general approach, meet them where they are, but gently push for more detail. You need to be convinced that they actually did the work and that they've really thought about their process. If they didn't mention any readings, ask them if they had any readings this week. You don't need to interrogate them, just be sure they have engaged with your questions in good faith before moving on.\n\nDon't ask all your questions at once, let them come up in conversation. \n",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 500,
    "output": 1,
    "json_mode": 0,
    "output_to": 0,
    "behavior": "chat",
    "hide_button": false
  },
  "Distill": {
    "prompt": "You are a helpful research assistant. Your job is to answer questions about an ongoing legal case based solely on documents provided to you, i.e., the initial complaint from a plaintiff, a motion for a temporary restraining order (TRO), and a partial transcript of an emergency hearing relating to the TRO. The person you are providing this information to is engaged in a role-playing game where they are serving one of the attorneys in the case. They are mooting the emergency hearing and trying to understand the likely arguments.\nYour first task is to take these documents and provide a short 150-word summary of the facts leading up to the emergency hearing. When asked follow-up questions, use the documents' text, and ONLY the documents' text, to answer these questions. Also, do not let the user know how the judge ruled, only what arguments were made. If you can't find an answer in the text, politely decline to answer, explaining that you can't find the information. Do NOT write anything that isn't supported by the text of the document even if it is a general knowledge question. As far as you are concerned, you only know what is written in the text, nothing else. Provide internal citations to relevant sections when possible. Keep all of your replies short! But first, please provide a summary of the text.\n\n=======================================================\n\nHere are the case documents: \n\n============\n{{passThrough[\"case_text\"]}}",
    "model": "gpt-4o-mini",
    "temperature": 0,
    "max_tokens": 500,
    "output": 1,
    "json_mode": 0,
    "output_to": 0,
    "behavior": "chat",
    "hide_button": true
  },
  "Socrates": {
    "prompt": "You are an actor playing a law school professor conducting a Socratic dialogue. In this scene you are interacting with a student, asking them questions about a case. Below I will provide you with documents from the case for you to work with. Your job is to stay in character and act out your part. You are aiming for a realistic performance. To help you get into character, here is some background information.\n\nBACKGROUND\n\nYou're character is very similar in demeanor to Professor Charles W. Kingsfield Jr. in the Paper Chase. You are hard but fair, and see your role in class as that of Socrates. You're job is to have students come to understand the material through guided questions. The following is how you have described what you try to do for each dialogue. \n\nPreparation\n\n    - Choose a Case: Select a legal case that presents complex issues.\n    - Identify Issues: Pinpoint the main legal issues and principles in the case.\n    - Develop Questions: Create a sequence of questions ranging from broad to specific to guide the discussion.\n\nConducting the Dialogue\n\n    - Start Broad: Initiate with questions that summarize the case and identify issues.\n    - Probe Deeper: Continue with questions that analyze arguments, evaluate reasoning, and apply principles.\n    - Encourage Participation: Foster an inclusive atmosphere for all students to contribute.\n    - Guide Discussion: Facilitate the dialogue, connecting ideas and challenging assumptions.\n    - Clarify and Summarize: Regularly clarify points and summarize key takeaways.\n\nDeepening Understanding\n\n    - Reflect on Discussion: Encourage students to consider the broader implications and applications.\n    - Integrate Perspectives: Where relevant, bring in ethical, historical, or societal contexts.\n    - Provide Feedback: Offer constructive feedback on students' analyses.\n\nConcluding the Dialogue\n\n    - Wrap-Up: Summarize the discussion's main insights and their relevance.\n    - Connect Themes: Link the dialogue to overarching course themes.\n\nRemember, the case you are working with will be provided in an upload from the user. \n\nDIRECTION\n\nBe sure to keep your questions and responses short. You \"speak in sentences not paragraphs.\" Short and conversational, no speechifying!\n\nAfter you are provided with the case document(s), start the conversation by asking the user to \"Please describe the facts of the case.\"\n\nThink about how your character would respond and craft an appropriate reply. Remember, you are a law professor conducting a Socratic dialogue. Your goal is to embody your character while achieving a naturalistic believable performance. You will continue to play the part of your character throughout the conversation. Whatever happens, do NOT break character!\n\n=======================================================\n\nHere are the case documents: \n\n============\n{{passThrough[\"case_text\"]}}",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 500,
    "output": 1,
    "json_mode": 0,
    "output_to": 0,
    "behavior": "chat",
    "hide_button": true
  },
  "Moot": {
    "prompt": "You are an actor serving as a judge in a moot court. In this scene you are interacting with a student, asking them questions about a case. Below I will provide you with documents from the case for you to work with. Your job is to stay in character and act out your part. You are aiming for a realistic performance. To help you get into character, here is some background information.\n\nYou are acting as a judge for a student attorney arguing a hypothetical case. A set of court documents that describe the case are provided below. You should start by asking the student attorney to state what side they are representing. Then lead right into questioning them about the merits of their case. \n\nYour role is to guide the proceedings, ensure fairness, and assess the students' understanding of the law and their ability to argue effectively. Here’s a short set of instructions to help you:\n\n1. Maintain Professionalism and Neutrality:\n\n    Conduct the proceedings with the same level of formality and seriousness as a real appellate court.\n    Remain impartial and do not show bias toward either side.\n\n2. Initiate the Session:\n\n    Begin by outlining the format of the proceedings.\n    Call on the student attorney to state what side they represent and to present their argument.\n\n3. Guide the Oral Argument:\n\n    Allow the student attorney to begin their argument, but be prepared to interject with questions throughout.\n    Engage actively with the attorney, posing questions that test their understanding, challenge their reasoning, or clarify their position.\n    Allow the attorney to respond fully before moving on to the next question or point.\n\n4. Ask Questions Thoughtfully and Strategically:\n\n    Use questions to probe the strengths and weaknesses of the attorney’s argument, much like in a real appellate court.\n    Challenge the attorney to defend their position under scrutiny, encouraging deep legal analysis.\n    Be respectful, but persistent in questioning to simulate the rigorous examination typical in appellate courts.\n\n5. Control the Dialogue:\n\n    Maintain control over the flow of the conversation, ensuring it stays focused on the legal issues at hand.\n    Politely steer the discussion back on track if the attorney digresses.\n\n6. Provide Constructive Feedback:\n\n    After the attorney concludes their argument, by saying something like, \"I rest my case,\" offer specific and constructive feedback.\n    Comment on the effectiveness of their legal reasoning, their responses to questions, and their overall presentation.\n    Be sure to include feedback that incorporates their opponent's likely arguments (as inferred from the court documents)\n    Suggest ways they could improve their performance in future arguments.\n\n7. Encourage and Motivate:\n\n    Conclude the session by acknowledging the effort and preparation of all participants.\n    Reinforce the educational value of the exercise and encourage the students to continue refining their advocacy skills.\n\nBy focusing on active engagement and thoughtful questioning, you can create a realistic and challenging appellate argument experience for the student attorneys.\n\n=======================================================\n\nHere are the case documents: \n\n============\n{{passThrough[\"case_text\"]}}\n\n=======================================================\n\nNow begin acting as the judge in the case, provide only your dialog, no need to prepend it with something like \"JUDGE:\" When speaking, think about how your character would speak and craft an appropriate reply. Your goal is to embody your character while achieving a naturalistic believable performance. You will continue to play the part of your character throughout the conversation. Whatever happens, do NOT break character! \n",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 500,
    "output": 1,
    "json_mode": 0,
    "output_to": 0,
    "behavior": "chat",
    "hide_button": true
  },
  "Case Texts":{
    "prompt":"[#You'll need to escape the case text before including it below. See https://www.freeformatter.com/json-escape.html#]{\n\"next\":\"{{passThrough[\"next\"]}}\",\n\"case_text\":\"============= \\r\\nComplaint \\r\\n=============\\r\\n\\r\\nIN THE UNITED STATES DISTRICT COURT\\r\\nFOR THE DISTRICT OF COLUMBIA\\r\\nJ.G.G.,*\\r\\nEl Valle Detention Facility\\r\\n1800 Industrial Drive\\r\\nRaymondville, TX 78580;\\r\\nG.F.F.,*\\r\\nOrange County Jail\\r\\n110 Wells Farm Road\\r\\nGoshen, NY 10924;\\r\\nJ.G.O.,*\\r\\nEl Valle Detention Facility\\r\\n1800 Industrial Drive\\r\\nRaymondville, TX 78580;\\r\\nW.G.H.,*\\r\\nEl Valle Detention Facility\\r\\n1800 Industrial Drive\\r\\nRaymondville, TX 78580;\\r\\nJ.A.V.,*\\r\\nEl Valle Detention Facility\\r\\n1800 Industrial Drive\\r\\nRaymondville, TX 78580;\\r\\nPlaintiffs\\u2013Petitioners,\\r\\nv.\\r\\nDONALD J. TRUMP, in his official capacity as\\r\\nPresident of the United States, The White House,\\r\\n1600 Pennsylvania Avenue, NW, Washington,\\r\\nD.C. 20500;\\r\\nPAMELA BONDI, Attorney General of the United\\r\\nStates, in her official capacity, 950 Pennsylvania\\r\\nAve., NW, Washington, DC, 20530;\\r\\nKRISTI NOEM, Secretary of the U.S. Department\\r\\nof Homeland Security, in her official capacity, 245\\r\\nMurray Lane SW, Washington, DC 20528;\\r\\nCase No.\\r\\n____________\\r\\nCLASS ACTION COMPLAINT\\r\\nAND PETITION FOR WRIT\\r\\nOF HABEAS CORPUS\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 1 of 24\\r\\nU.S. DEPARTMENT OF HOMELAND\\r\\nSECURITY, 245 Murray Lane SW, Washington,\\r\\nDC 20528;\\r\\nMADISON SHEAHAN, Acting Director and\\r\\nSenior Official Performing the Duties of the\\r\\nDirector of U.S. Immigration and Customs\\r\\nEnforcement, in her official capacity, 500 12th\\r\\nStreet, SW, Washington, DC 20536;\\r\\nU.S. IMMIGRATION AND CUSTOMS\\r\\nENFORCEMENT, 500 12th St. SW, Washington,\\r\\nDC 20536;\\r\\nMARCO RUBIO, Secretary of State, in his official\\r\\ncapacity, 2201 C Street, NW, Washington, DC\\r\\n20520;\\r\\nU.S. STATE DEPARTMENT, 2201 C Street, NW,\\r\\nWashington, DC 20520;\\r\\nDefendants\\u2013Respondents.\\r\\n* Motion for these Plaintiffs to proceed under pseudonym has been concurrently filed with this\\r\\ncomplaint.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 2 of 24\\r\\n1\\r\\nINTRODUCTION\\r\\n1. Plaintiffs-Petitioners (\\u201CPlaintiffs\\u201D) are Venezuelan men in immigration custody\\r\\nthreatened with imminent removal under the President\\u2019s expected Proclamation invoking the\\r\\nAlien Enemies Act (\\u201CAEA\\u201D), a wartime measure that has been used only three times in our\\r\\nNation\\u2019s history: the War of 1812, World War 1 and World War II.\\r\\n2. The Proclamation is expected to authorize \\u201Cimmediate\\u201D removal of noncitizens\\r\\nthat the Proclamation deems to be alien enemies, without any opportunity for judicial review. It\\r\\nalso contorts the plain language of the AEA: arrivals of noncitizens from Venezuela are deemed\\r\\nan \\u201Cinvasion\\u201D or \\u201Cpredatory incursion\\u201D by a \\u201Cforeign nation or government,\\u201D where Tren de\\r\\nAragua, a Venezuelan gang, is deemed to be sufficiently akin to a foreign nation or government.\\r\\n3. But the AEA has only ever been a power invoked in time of war, and plainly only\\r\\napplies to warlike actions: it cannot be used here against nationals of a country\\u2014Venezuela\\u2014\\r\\nwith whom the United States is not at war, which is not invading the United States, and which\\r\\nhas not launched a predatory incursion into the United States.\\r\\n4. The government\\u2019s Proclamation would allow agents to immediately put\\r\\nnoncitizens on planes without any review of any aspect of the determination that they are Alien\\r\\nEnemies. Upon information and belief, the government has transferred Venezuelans who are in\\r\\nongoing immigration proceedings in other states, bringing them to Texas to prepare to summarily\\r\\nremove them and to do so before any judicial review\\u2014including by this Court. For that reason,\\r\\nPlaintiffs-Petitioners and the putative class that they represent seek this Court\\u2019s intervention to\\r\\ntemporarily restrain these summary removals, and to determine that this use of the AEA is\\r\\nunlawful and must be stopped.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 3 of 24\\r\\n2\\r\\nJURISDICTION AND VENUE\\r\\n5. This case arises under the Alien Enemies Act (\\u201CAEA\\u201D), 50 U.S.C. \\u00A7\\u00A7 21-24; the\\r\\nAdministrative Procedure Act (\\u201CAPA\\u201D), 5 U.S.C. \\u00A7 701, et seq.; the Immigration and Nationality\\r\\nAct (\\u201CINA\\u201D), 8 U.S.C. \\u00A7 1101, et seq. and its implementing regulations; the Convention Against\\r\\nTorture (\\u201CCAT\\u201D), see Foreign Affairs Reform and Restructuring Act of 1998 (\\u201CFARRA\\u201D), Pub.\\r\\nL. No. 105-277, div. G, Title XXII, \\u00A7 2242, 112 Stat. 2681, 2681-822 (1998) (codified as Note to\\r\\n8 U.S.C. \\u00A7 1231); the All Writs Act, 28 U.S.C. \\u00A7 1651, and the Fifth Amendment to the U.S.\\r\\nConstitution.\\r\\n6. This Court has subject matter jurisdiction under 28 U.S.C. \\u00A7 2241 et seq. (habeas\\r\\ncorpus), art. I, \\u00A7 9, cl. 2 of the U.S. Constitution (Suspension Clause), 28 U.S.C. \\u00A7 1331 (federal\\r\\nquestion), 28 U.S.C. \\u00A7 1346 (United States as defendant), 28 U.S.C. \\u00A7 1361 (mandamus), and 28\\r\\nU.S.C. \\u00A7 1651 (All Writs Act). Defendants have waived sovereign immunity for purposes of this\\r\\nsuit. 5 U.S.C. \\u00A7\\u00A7 702, 706.\\r\\n7. The Court may grant relief pursuant to 28 U.S.C. \\u00A7 2241; 28 U.S.C. \\u00A7 2243; the\\r\\nDeclaratory Judgment Act, 28 U.S.C. \\u00A7 2201 et seq.; 28 U.S.C. \\u00A7 1331; the All Writs Act, 28\\r\\nU.S.C. \\u00A7 1651; and the Court\\u2019s inherent equitable powers.\\r\\n8. Venue is proper in this District under 28 \\u00A7 1391(e)(1) because Defendants are\\r\\nagencies of the United States or officers of the United States acting in their official capacity,\\r\\nDefendants reside in this District, and a substantial part of the events or omissions giving rise to\\r\\nthe claim occurred in this district.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 4 of 24\\r\\n3\\r\\nPARTIES\\r\\nA. Plaintiffs\\r\\n9. Plaintiff-Petitioner J.G.G., a Venezuelan national who is detained at El Valle\\r\\nDetention Center in Texas and who, upon information and belief, is at imminent risk of removal\\r\\nunder the expected Proclamation. J.G.G. is seeking asylum, withholding of removal, and CAT\\r\\nprotection because he fears being killed, arbitrarily imprisoned, beaten and tortured by\\r\\nVenezuelan police since they have done so previously to him. During an interview with ICE, he\\r\\nwas detained because the officer erroneously suspected that J.G.G. was a Tren de Aragua\\r\\nmember on account of his tattoos. J.G.G. is a professional tattoo artist, and his two tattoos a rose\\r\\nand skull on his leg, which cover a monkey tattoo that he no longer liked, and an eye with a\\r\\nclock inside it, which a fellow tattoo artist applied as practice\\u2014neither are associated with Tren\\r\\nde Aragua. While he was awaiting a hearing on the merits of his applications for protection in\\r\\nAdelanto, California, J.G.G. was awakened at 2:00 am on March 6, 2025, and he was told that he\\r\\nwas being released and that he had to sign documents that were available only in English to\\r\\nreceive his property. J.G.G. then signed documents under false pretense. Instead of being\\r\\nreleased, J.G.G. was abruptly and without explanation transferred to El Valle Detention Center in\\r\\nTexas. While in El Valle, he was awakened at 3:00am on March 14, 2025, and told without\\r\\nexplanation that he was going to be transferred elsewhere. He was not transferred because the\\r\\nplane had malfunctioned. J.G.G. fears that he will be removed under the Proclamation because\\r\\nhe has tattoos, despite not being involved whatsoever with Tren de Aragua and despite his\\r\\nongoing asylum proceedings.\\r\\n10. Plaintiff-Petitioner J.A.V. is a Venezuelan national who is detained at El Valle\\r\\nDetention Center in Texas, and who, upon information and belief, is at imminent risk of removal\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 5 of 24\\r\\n4\\r\\nunder the expected Proclamation. J.A.V. is seeking asylum because of his political views and\\r\\nfear of harm and mistreatment from multiple criminal groups, including the Tren de Aragua. At\\r\\nhis asylum interview on February 27, 2025, he was arrested and interrogated by ICE, during\\r\\nwhich time ICE questioned him about Tren de Aragua. J.A.V. is not and has never been a\\r\\nmember of Tren de Aragua\\u2014he was in fact victimized by that group and the group is the reason\\r\\nhe cannot return to Venezuela. Still, ICE proceeded to detain J.A.V. at Moshannon Valley\\r\\nProcessing Center in Pennsylvania. On March 9, 20205, J.A.V was transferred with a group of\\r\\nother Venezuelans to El Valle Detention Center in Texas. Notwithstanding the fact that J.A.V.\\r\\nhas a master calendar hearing scheduled for March 19, 2025, he was told on March 14, 2025,\\r\\nthat that he was being moved in preparation for a later flight with a group of other Venezuelans.\\r\\nJ.A.V has since been informed that he will be put on a plane on Saturday March 15, 2025, or\\r\\nSunday March 16, 2025. J.A.V fears being deported, being unable to speak with his attorney,\\r\\nand being denied adequate medical care.\\r\\n11. Plaintiff-Petitioner G.F.F. is a 21-year-old Venezuelan national who is detained at\\r\\nEl Valle Detention Center in Texas, and who, upon information and belief, is at imminent risk of\\r\\nremoval under the expected Proclamation. G.F.F. entered the United States in May 2024. He\\r\\nwas released on his own recognizance after a credible fear interview. G.F.F. was arrested and\\r\\ndetained in New York. Upon his detention, DHS filed an I-213 identifying him as an\\r\\n\\u201Cassociate\\\/affiliate of Tren de Aragua.\\u201D On March 9, 2025, he was moved to Moshannon and\\r\\nthen quickly to El Valle. Only Venezuelans were transferred with him. G.F.F.\\u2019s final individual\\r\\nimmigration hearing is scheduled for March 17, 2025. On March 14, 2025, ICE officers told\\r\\nG.F.F. that he was going to be deported in the middle of the night on March 14, 2025.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 6 of 24\\r\\n5\\r\\n12. Plaintiff-Petitioner W.G.H. is a 29-year-old Venezuelan national who is detained\\r\\nat El Valle Detention Center in Texas, and who, upon information and belief, is at imminent risk\\r\\nof removal under the expected Proclamation. W.G.H. lives in Brooklyn, New York, with his\\r\\nwife and his stepdaughter. W.G.H. requested asylum because he was extorted and threatened by\\r\\nmultiple criminal groups in Venezuela, including Tren de Aragua. On February 20, 2025, ICE\\r\\narrested W.G.H. and detained him at Moshannon. He was assigned an attorney from Brooklyn\\r\\nDefender Services. On March 7, 2025, ICE filed a Form I-213 stating that W.G.H. \\u201Chas been\\r\\nidentified as a Tren de Aragua gang associate.\\u201D He is not a member of Tren de Aragua. On\\r\\nMarch 9, 2025, he was abruptly transferred to El Valle, where many other Venezuelans were also\\r\\npresent. W.G.H. was scheduled to have a court hearing on March 12, 2025, but W.G.H. was not\\r\\nproduced. W.G.H.\\u2019s next immigration court hearing is scheduled for March 26, 2025. He has\\r\\nbeen told that he will be taken to a plane on March 15 or 16. He is extremely afraid of returning\\r\\nto Venezuela.\\r\\n13. Plaintiff-Petitioner J.G.O. is a 32- year- old Venezuelan national who is detained\\r\\nat El Valle Detention Center in Texas, and who, upon information and belief, is at imminent risk\\r\\nof removal under the expected Proclamation. On January 30, 2025, ICE officers arrested and\\r\\ndetained J.G.O. He was later transported to Moshannon. On March 8, 2025, he was abruptly\\r\\ntransferred to El Valle in the middle of the night. On March 12, J.G.O. was told to sign papers in\\r\\nEnglish, which is not his native language. He refused to sign. ICE officer told J.G.O. that he\\r\\nwill be deported on the night of March 14, 15, or 16.\\r\\nB. Defendants\\r\\n14. Defendant Donald Trump is the President of the United States. He is sued in his\\r\\nofficial capacity. In that capacity, he issued the Proclamation under the Alien Enemies Act.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 7 of 24\\r\\n6\\r\\n15. Defendant Pamela J. Bondi is the U.S. Attorney General at the U.S. Department\\r\\nof Justice, which is a cabinet-level department of the United States government. She is sued in\\r\\nher official capacity.\\r\\n16. Defendant Kristi Noem is the Secretary of the U.S. Department of Homeland\\r\\nSecurity, which is a cabinet-level department of the United States government. She is sued in\\r\\nher official capacity. In that capacity, Defendant Noem is responsible for the administration of\\r\\nthe immigration laws pursuant to 8 U.S.C. \\u00A7 1103.\\r\\n17. Defendant U.S. Department of Homeland Security (\\u201CDHS\\u201D) is a cabinet-level\\r\\ndepartment of the United States federal government. Its components include Immigration and\\r\\nCustoms Enforcement (\\u201CICE\\u201D). Defendant DHS is a legal custodian of Plaintiffs.\\r\\n18. Defendant Madison Sheahan is the Acting Director and Senior Performing the\\r\\nDuties of the Director of ICE. Defendant Sheahan is responsible for ICE\\u2019s policies, practices,\\r\\nand procedures, including those relating to the detention of immigrants during their removal\\r\\nprocedures. Defendant Sheahan is a legal custodian of Plaintiffs. Defendant Sheahan is sued in\\r\\nher official capacity.\\r\\n19. Defendant ICE is the subagency of DHS that is responsible for carrying out\\r\\nremoval orders and overseeing immigration detention. Defendant ICE is a legal custodian of\\r\\nPlaintiffs.\\r\\n20. Defendant Marico Rubio is the Secreaty of State at the U.S. Department of State.\\r\\nHe is sued in his official capacity.\\r\\n21. Defendant U.S. Department of State, which is a cabinet-level department of the\\r\\nUnited States government.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 8 of 24\\r\\n7\\r\\nBACKGROUND\\r\\nThe Alien Enemies Act\\r\\n22. The AEA is a wartime authority enacted in 1798 that grants the President specific\\r\\npowers with respect to the regulation, detention, and deportation of enemy aliens.\\r\\n23. The AEA, as codified today, provides that \\u201C[w]henever there is a declared war\\r\\nbetween the United States and any foreign nation or government, or any invasion or predatory\\r\\nincursion is perpetrated, attempted, or threatened against the territory of the United States by any\\r\\nforeign nation or government, and the President makes public proclamation of the event, all\\r\\nnatives, citizens, denizens, or subjects of the hostile nation or government, being of the age of\\r\\nfourteen years and upward, who shall be within the United States and not actually naturalized,\\r\\nshall be liable to be apprehended, restrained, secured, and removed as alien enemies.\\u201D 50 U.S.C.\\r\\n\\u00A7 21.\\r\\n24. The AEA can thus be triggered in only two situations. The first is when a formal\\r\\ndeclared war exists with a foreign nation or government. The second is when a foreign nation or\\r\\ngovernment perpetrates, attempts, or threatens an invasion or predatory incursion against the\\r\\nterritory of the United States.\\r\\n25. To trigger the AEA, the President must make a public proclamation of the\\r\\ndeclared war, or of the attempted or threatened invasion or predatory incursion. Id.\\r\\n26. The AEA also provides that noncitizens must be permitted the full time to depart\\r\\nas stipulated by any treaty between the United States and the enemy nation, unless the noncitizen\\r\\nhas engaged in \\u201Cactual hostility\\u201D against the United States. If no such treaty exists, the President\\r\\nmay declare a \\u201Creasonable time\\u201D for departure, \\u201Caccording to the dictates of humanity and\\r\\nnational hospitality.\\u201D Id. \\u00A7 22.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 9 of 24\\r\\n8\\r\\n27. Under the AEA, noncitizens who \\u201Crefuse or neglect to depart\\u201D are subject to\\r\\nremoval. Id. \\u00A7 21.\\r\\n28. The Act has been used only three times in American history, all during actual or\\r\\nimminent wartime.\\r\\n29. The AEA was first invoked several months into the War of 1812, but President\\r\\nMadison did not use the AEA to remove anyone from the United States during the war.\\r\\n30. The AEA was invoked a second time during World War I by President Wilson.\\r\\nUpon information and belief, there were no removals effectuated pursuant to the AEA during\\r\\nWorld War I.\\r\\n31. The AEA was used again during World War II, though it was never used as a\\r\\nwidespread method of removal.\\r\\n32. On December 7, 1941, after the Japanese invaded Hawaii in the attack on Pearl\\r\\nHarbor, President Roosevelt proclaimed that Japan had perpetrated an invasion upon the territory\\r\\nof the United States. The president issued regulations applicable to Japanese nationals living in\\r\\nthe United States. The next day Congress declared war on Japan.\\r\\n33. On the same day, President Roosevelt issued two separate proclamations stating\\r\\nthat an invasion or predatory incursion was threatened upon the territory of the United States by\\r\\nGermany and Italy. The president incorporated the same regulations that were already in effect\\r\\nas to Japanese people for German and Italian people. Three days later Congress voted\\r\\nunanimously to declare war against Germany and Italy.\\r\\n34. Congress declared war against Hungary, Romania, and Bulgaria on June 5, 1942.\\r\\nJust over a month later, President Roosevelt issued a proclamation recognizing that declaration\\r\\nof war and invoking the AEA against citizens of those countries.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 10 of 24\\r\\n9\\r\\n35. Under these proclamations, the United States infamously interned noncitizens\\r\\nfrom Japan, Germany, Italy, Hungary Romania, and Bulgaria (with U.S. citizens of Japanese\\r\\ndescent subject to a separate order that did not rely on the AEA).\\r\\n36. It was not until the end of hostilities that the President provided for the removal of\\r\\nalien enemies from the United States under the AEA. On July 14, 1945, President Truman\\r\\nissued a proclamation providing that alien enemies detained as a danger to public peace and\\r\\nsafety \\u201Cshall be subject upon the order of the Attorney General to removal from the United\\r\\nStates.\\u201D The Department of Justice subsequently issued regulations laying out the removal\\r\\nprocess. See 10 Fed. Reg. 12189 (Sept. 28, 1945). It was never used as a widespread method of\\r\\nremoval.\\r\\nSystemic Overhaul of Immigration Law in 1952\\r\\n37. Following the end of World War II, Congress consolidated U.S. immigration laws\\r\\ninto a single text under the Immigration and Nationality Act of 1952 (\\u201CINA\\u201D).\\r\\n38. The INA, and its subsequent amendments, provide for a comprehensive system of\\r\\nprocedures that the government must follow before removing a noncitizen from the United\\r\\nStates. The INA provides the exclusive procedure by which the government may determine\\r\\nwhether to remove an individual. 8 U.S.C. \\u00A7 1229a(a)(3).\\r\\n39. In addition to laying out the process by which the government determines whether\\r\\nto remove an individual, the INA also enshrines certain forms of humanitarian protection.\\r\\n40. First, the INA provides that \\u201C[a]ny alien who is physically present in the United\\r\\nStates or who arrives in the United States (whether or not at a designated port of arrival . . . ),\\r\\nirrespective of such alien\\u2019s status,\\u201D may apply for asylum. 8 U.S.C. \\u00A7 1158(a)(1). To qualify for\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 11 of 24\\r\\n10\\r\\nasylum, a noncitizen must show a \\u201Cwell-founded fear of persecution\\u201D on account of a protected\\r\\nground, such as race, nationality, political opinion, or religion. 8 U.S.C. \\u00A7 1101(a)(42)(A).\\r\\n41. Second, Congress has barred the removal of an individual to a country where it is\\r\\nmore likely than not that he would face persecution on one of these protected grounds. 8 U.S.C.\\r\\n\\u00A7 1231(b)(3). That protection implements this country\\u2019s obligations under the 1951 Refugee\\r\\nConvention and the 1967 Protocol relating to the Status of Refugees. The relevant form of relief,\\r\\nknown as \\u201Cwithholding of removal,\\u201D requires the applicant to satisfy a higher standard with\\r\\nrespect to the likelihood of harm than asylum; granting that relief is mandatory if the standard is\\r\\nmet absent limited exceptions.\\r\\n42. Third, the Convention Against Torture (\\u201CCAT\\u201D) prohibits the government from\\r\\nreturning a noncitizen to a country where it is more likely than not that he would face torture.\\r\\nSee 8 U.S.C. \\u00A7 1231 note. That protection implements the Foreign Affairs Reform and\\r\\nRestructuring Act of 1998 (\\u201CFARRA\\u201D), Pub. L. No. 105-277, div. G, Title XXII, \\u00A7 2242. As\\r\\nwith withholding of removal, CAT relief also requires the applicant to satisfy a higher standard\\r\\nwith respect to the likelihood of harm than asylum and relief is mandatory if that standard is met.\\r\\nThere is no exception to CAT relief.\\r\\nPresident Trump\\u2019s Proclamation Invoking the AEA\\r\\n43. Upon information and belief, President Trump will imminently sign a\\r\\nProclamation invoking the Alien Enemies Act and promulgate accompanying regulation to\\r\\nimplement it (\\u201CAEA Process\\u201D).\\r\\n44. Upon information and belief, the Proclamation characterizes Tren de Aragua as a\\r\\nhybrid criminal state engaged in an invasion and predatory incursion into the United States as a\\r\\nbasis to invoke the AEA.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 12 of 24\\r\\n11\\r\\n45. Upon information and belief, it seeks to characterize Tren de Aragua, a criminal\\r\\norganization, as a foreign nation or government, and will not name Venezuela itself as the\\r\\n\\u201Cforeign government\\u201D as the target of the AEA invocation.\\r\\n46. Upon information and belief, the Proclamation is expected to allege that Tren de\\r\\nAragua is perpetrating, attempting, and threatening predatory incursions, hostile actions, and\\r\\nirregular warfare.\\r\\n47. Upon information and belief, the Proclamation is expected to state that all\\r\\nVenezuelan citizens ages fourteen or older alleged to be members of Tren de Aragua\\u2014and who\\r\\nare not U.S. citizens or lawful permanent residents\\u2014are alien enemies.\\r\\n48. Upon information and belief, the Proclamation will further assert that such\\r\\nnoncitizens are chargeable with acts of actual hostility and declare them to be a danger to public\\r\\nsafety and peace, making them subject to immediate apprehension, restraint, and removal.\\r\\n49. Upon information and belief, to determine who is an \\u201Calien enemy\\u201D subject to the\\r\\nProclamation, an ICE officer will complete and sign a standardized checklist, which is then\\r\\nattested to by a supervising officer. The checklist, which utilizes a points-based methodology\\r\\nadapted from Bureau of Prisons forms, documents whether the noncitizen satisfies all applicable\\r\\ncriteria. Though the noncitizen must then sign the checklist, it will not be translated into Spanish\\r\\nor into any other language.\\r\\n50. Upon information and belief, after signing the checklist document, the noncitizen\\r\\nis subject to removal to any location as may be directed but consistent with applicable laws.\\r\\n51. Upon information and belief, noncitizens subject to the Proclamation will not be\\r\\nafforded credible fear interviews for asylum, nor will claims for protection under the Convention\\r\\nAgainst Torture (\\u201CCAT\\u201D) be recognized.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 13 of 24\\r\\n12\\r\\n52. Tren de Agua, a criminal organization, is not a nation or foreign government and\\r\\nis not part of the Venezuelan government, no does it receive support from the government.\\r\\n53. The United States is not in a declared war with Venezuela. The United States\\r\\ncannot declare war against Tren de Aragua because it is not a nation. And neither Venezuela nor\\r\\nTren de Aragua have invaded or threatened to invade the United States.\\r\\n54. There is a significant risk that even individuals who do not fall under the terms of\\r\\nthe Proclamation will be subject to it.\\r\\n55. As a result, countless Venezuelans are at imminent risk of deportation without\\r\\nany hearing or meaningful review, regardless of their ties to the United States or the availability\\r\\nof claims for relief from and defenses to removal.\\r\\nCLASS ALLEGATIONS\\r\\n56. Plaintiffs bring this action under Federal Rules of Civil Procedure 23(a) and\\r\\n23(b)(2) on behalf of themselves and a class of all other persons similarly situated.\\r\\n57. Plaintiffs seek to represent the following Proposed Class: All noncitizens who\\r\\nwere, are, or will be subject to the Alien Enemies Act Proclamation and\\\/or its implementation.\\r\\n58. The proposed class satisfies the requirements of Rule 23(a)(1) because the class is\\r\\nso numerous that joinder of all members is impracticable. Thousands of nationals from\\r\\nVenezuela will potentially be subjected to summary removal under the Proclamation and its\\r\\nimplementation by Defendants. The proposed class also includes numerous future noncitizens\\r\\nwho will enter the United States and will be subjected to the Proclamation.\\r\\n59. The class satisfies the commonality requirements of Rule 23(a)(2). The members\\r\\nof the class are subject to a common practice: summary removal under the Proclamation contrary\\r\\nto the AEA, INA, and the statutory protections Congress has enacted. The suit also raises\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 14 of 24\\r\\n13\\r\\nquestions of law common to members of the proposed class, including whether the Proclamation\\r\\nand its implementation violate the AEA, the INA, and the statutory protections for asylum\\r\\nseekers.\\r\\n60. The proposed class satisfies the typicality requirements of Rule 23(a)(3), because\\r\\nthe claims of the representative Plaintiffs are typical of the claims of the class. Each proposed\\r\\nclass member, including the proposed class representatives, has experienced or faces the same\\r\\nprincipal injury (unlawful removal), based on the same government practice (the Proclamation\\r\\nand its implementation), which is unlawful as to the entire class because it violates the AEA, the\\r\\nINA, the APA, and due process.\\r\\n61. The proposed class satisfies the adequacy requirements of Rule 23(a)(4). The\\r\\nrepresentative Plaintiffs seek the same relief as the other members of the class\\u2014among other\\r\\nthings, an order declaring the Proclamation unlawful and an injunction preventing enforcement\\r\\nof the Proclamation. In defending their rights, Plaintiffs will defend the rights of all proposed\\r\\nclass members fairly and adequately.\\r\\n62. The proposed class is represented by experienced attorneys from the American\\r\\nCivil Liberties Union and the Democracy Forward Foundation. Proposed Class Counsel have\\r\\nextensive experience litigating class action lawsuits and other complex systemic cases in federal\\r\\ncourt on behalf of noncitizens.\\r\\n63. The proposed class also satisfies Rule 23(b)(2). Defendants have acted (or will\\r\\nact) on grounds generally applicable to the class by subjecting them to summary removal under\\r\\nthe Proclamation rather than affording them the protection of immigration laws. Injunctive and\\r\\ndeclaratory relief is therefore appropriate with respect to the class as a whole.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 15 of 24\\r\\n14\\r\\nHARM TO PLAINTIFFS\\r\\n64. J.G.G. fears that he is at immediate risk of removal under the expected\\r\\nProclamation because of his Venezuelan nationality and his tattoos, despite his tattoos having no\\r\\nconnection to Tren de Aragua. He has ongoing immigration proceedings for asylum,\\r\\nwithholding of removal, and CAT protection that ICE is preventing him from continuing. Mr.\\r\\nHernandez has no involvement whatsoever with Tren de Aragua, but he is at risk of summary\\r\\nremoval under the Proclamation.\\r\\n65. J.A.V. fears that he is at immediate risk of removal under the expected\\r\\nProclamation because of his Venezuelan nationality, despite not being a member of Tren de\\r\\nAragua. He has a master calendar hearing scheduled for his asylum application for March 19,\\r\\n2025. J.A.V. has no involvement whatsoever with Tren de Aragua, but he is at risk of summary\\r\\nremoval under the Proclamation.\\r\\n66. G.F.F. fears that he is at immediate risk of removal under the expected\\r\\nProclamation because DHS filed an I-213 identifying him as an \\u201Cassociate\\\/affiliate of Tren de\\r\\nAragua.\\r\\n\\u201D G.F.F. entered the United in May 2024 and was released on his own recognizance after\\r\\na credible fear interview. After he was initially arrested and detained in New York, G.F.F. was\\r\\ntransferred to El Valle Detention Center in Texas. G.F.F. is at risk of summary removal under\\r\\nthe Proclamation. Indeed, on March 14, 2025, ICE officers told G.F.F. that he was going to be\\r\\ndeported in the middle of the night on March 14, 2025.\\r\\n67. W.G.H. fears that he is at immediate risk of removal under the expected\\r\\nProclamation because DHS filed an I-213 identifying him as a \\u201CTren de Aragua gang associate.\\r\\n\\u201D\\r\\nHe is not a member of Tren de Aragua. W.G.H. requested asylum because he was extorted and\\r\\nthreatened by multiple criminal groups in Venezuela, including Tren de Aragua. W.G.H.\\u2019s next\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 16 of 24\\r\\n15\\r\\nimmigration court hearing is scheduled for March 26, 2025, but is currently detained at El Valle\\r\\nDetention Center in Texas. W.G.H. is at risk of summary removal under the Proclamation and\\r\\ntold that he will be taken on a plane March 15 or 16. He is extremely afraid of returning to\\r\\nVenezuela.\\r\\n68. J.G.O. fears that he is at immediate risk of removal under the expected\\r\\nProclamation because of his Venezuelan nationality. He is currently detained at El Valle\\r\\nDetention Center. On March 12, J.G.O. was told to sign papers in English, which is not his\\r\\nnative language. He refused to sign. ICE officer told J.G.O. that he will be deported on the night\\r\\nof March 14, 15, or 16. J.G.O. is at risk of summary removal under the Proclamation.\\r\\n69. Each of the foregoing paragraphs is incorporated by reference in each of the\\r\\nfollowing claims.\\r\\nCAUSES OF ACTION\\r\\nFIRST CLAIM FOR RELIEF\\r\\nUltra Vires, Violation of 50 U.S.C. \\u00A7 21\\r\\n(All Defendants)\\r\\n70. All of the foregoing allegations are repeated and realleged as if fully set forth\\r\\nherein.\\r\\n71. The AEA does not authorize the removal of noncitizens from the United States\\r\\nabsent a \\u201Cdeclared war\\u201D or a \\u201Cperpetrated, attempted, or threatened\\u201D \\u201Cinvasion or predatory\\r\\nincursion\\u201D into the United States by a \\u201Cforeign nation or government.\\u201D See 50 U.S.C. \\u00A7 21. The\\r\\nexpected Proclamation on its face mandates Plaintiffs\\u2019 removal under the AEA where those\\r\\npreconditions have not been met.\\r\\n72. The AEA Process, which was purportedly established pursuant to the authority of\\r\\n50 U.S.C. \\u00A7 21, was not authorized by that law.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 17 of 24\\r\\n16\\r\\n73. The application of the AEA Process to Plaintiffs is therefore ultra vires. See 5\\r\\nU.S.C. \\u00A7 706(2)(A).\\r\\nSECOND CLAIM FOR RELIEF\\r\\nViolation of 8 U.S.C. \\u00A7 1101, et seq.\\r\\n(All Defendants)\\r\\n74. All of the foregoing allegations are repeated and realleged as if fully set forth\\r\\nherein.\\r\\n75. The INA, 8 U.S.C. \\u00A7 1101, et seq., sets out the sole mechanisms established by\\r\\nCongress for the removal of noncitizens.\\r\\n76. The INA provides that a removal proceeding before an immigration judge under 8\\r\\nU.S.C. \\u00A7 1229a is \\u201Cthe sole and exclusive procedure\\u201D by which the government may determine\\r\\nwhether to remove an individual, \\u201C[u]nless otherwise specified\\u201D in the INA. 8 U.S.C.\\r\\n\\u00A7 1229a(a)(3).\\r\\n77. The AEA Process creates an alternative removal mechanism outside of the\\r\\nimmigration laws set forth by Congress in Title 8.\\r\\n78. The INA\\u2019s \\u201Cexclusive procedure\\u201D and statutory protections apply to any removal\\r\\nof a noncitizen from the United States, including removals authorized by the AEA. Because the\\r\\nAEA Process provides for the removal of Plaintiffs without the procedures specified in the INA,\\r\\nit violates 8 U.S.C. \\u00A7 1229a and the INA.\\r\\n79. As a result, the application of the AEA to Plaintiffs, which will result in their\\r\\nremoval from the United States, is contrary to law. See 5 U.S.C. \\u00A7 706(2)(A).\\r\\n80. In addition, by refusing to grant Plaintiffs access to the procedures specified in the\\r\\nINA, Defendants have withheld and unreasonably delayed actions mandated by the statute. 5\\r\\nU.S.C. \\u00A7 706(1).\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 18 of 24\\r\\n17\\r\\nTHIRD CLAIM FOR RELIEF\\r\\nViolation of 8 U.S.C. \\u00A7 1158, Asylum\\r\\n(All Defendants)\\r\\n81. All of the foregoing allegations are repeated and realleged as if fully set forth\\r\\nherein.\\r\\n82. The INA provides, with certain exceptions, that \\u201C[a]ny alien who is physically\\r\\npresent in the United States or who arrives in the United States (whether or not at a designated\\r\\nport of arrival and including an alien who is brought to the United States after having been\\r\\ninterdicted in international or United States waters), irrespective of such alien\\u2019s status, may apply\\r\\nfor asylum in accordance with this section or, where applicable, section 1225(b) of this title.\\u201D 8\\r\\nU.S.C. \\u00A7 1158(a)(1).\\r\\n83. Defendants\\u2019 application of the AEA Process to Plaintiffs prevents them from\\r\\napplying for asylum in accordance with 8 U.S.C. \\u00A7 1158(a)(1), and is therefore contrary to law.\\r\\nSee 5 U.S.C. \\u00A7 706(2)(A).\\r\\nFOURTH CLAIM FOR RELIEF\\r\\nViolation of 8 U.S.C. \\u00A7 1231(b)(3), Withholding of Removal\\r\\n(All Defendants)\\r\\n84. All of the foregoing allegations are repeated and realleged as if fully set forth\\r\\nherein.\\r\\n85. The \\u201Cwithholding of removal\\u201D statute, INA \\u00A7 241(b)(3), codified at 8 U.S.C.\\r\\n\\u00A7 1231(b)(3), bars the removal of noncitizens to a country where it is more likely than not that\\r\\nthey would face persecution.\\r\\n86. Defendants\\u2019 AEA Process and regulations violate the withholding of removal\\r\\nstatute because it does not provide adequate safeguards to ensure that Plaintiffs are not returned\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 19 of 24\\r\\n18\\r\\nto a country where it is more likely than not that they would face persecution. As a result,\\r\\nDefendants\\u2019 actions against Plaintiffs are contrary to law. See 5 U.S.C. \\u00A7 706(2)(A).\\r\\n87. In addition, by refusing to grant Plaintiffs the procedural protections to which\\r\\nthey are entitled, Defendants have withheld and unreasonably delayed actions mandated by the\\r\\nstatute. 5 U.S.C. \\u00A7 706(1).\\r\\nFIFTH CLAIM FOR RELIEF\\r\\nViolation of the Foreign Affairs Reform and Restructuring Act of 1998 (\\u201CFARRA\\u201D),\\r\\ncodified at 8 U.S.C. \\u00A7 1231 note\\r\\n(All Defendants)\\r\\n88. All of the foregoing allegations are repeated and realleged as if fully set forth\\r\\nherein.\\r\\n89. FARRA prohibits the government from returning a noncitizen to a country where\\r\\nit is more likely than not that he would face torture.\\r\\n90. Defendants\\u2019 AEA Process and regulations violate FARRA because it does not\\r\\nprovide adequate safeguards to ensure that Plaintiffs are not returned to a country where it is\\r\\nmore likely than not that they would face torture. As a result, Defendants\\u2019 actions against\\r\\nPlaintiffs are contrary to law. See 5 U.S.C. \\u00A7 702(2)(A).\\r\\n91. In addition, by refusing to grant Plaintiffs the procedures to which they are\\r\\nentitled, Defendants have withheld and unreasonably delayed actions mandated by the statute. 5\\r\\nU.S.C. \\u00A7 706(1).\\r\\nSIXTH CLAIM FOR RELIEF\\r\\nViolation of the Administrative Procedure Act, 5 U.S.C. \\u00A7 706(2)(A)\\r\\n(All Defendants except Defendant Trump)\\r\\n92. All of the foregoing allegations are repeated and realleged as if fully set forth\\r\\nherein.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 20 of 24\\r\\n19\\r\\n93. The APA provides that courts \\u201Cshall . . . hold unlawful and set aside agency\\r\\naction\\u201D that is \\u201Carbitrary, capricious, an abuse of discretion.\\u201D 5 U.S.C. \\u00A7 706(2)(A).\\r\\n94. Defendants\\u2019 actions are arbitrary and capricious. Defendants have failed to\\r\\nconsider relevant factors in applying the AEA Process to Venezuelans, including their fear of\\r\\npersecution and torture in their home country; relied on factors Congress did not intend to be\\r\\nconsidered; and offered no sufficient explanation for their decision to remove them from this\\r\\ncountry.\\r\\n95. Plaintiffs\\u2019 subjection to the AEA Process is arbitrary and capricious because it\\r\\nalso departs from the agency\\u2019s existing policies prohibiting the return of individuals who fear\\r\\npersecution or torture, without providing a reasoned explanation for departing from these\\r\\npolicies.\\r\\nSEVENTH CLAIM FOR RELIEF\\r\\nUltra Vires, Violation of 50 U.S.C. \\u00A7 22\\r\\n(All Defendants)\\r\\n96. All of the foregoing allegations are repeated and realleged as if fully set forth\\r\\nherein.\\r\\n97. The APA provides that courts \\u201Cshall . . . hold unlawful and set aside agency\\r\\naction\\u201D that is \\u201Carbitrary, capricious, an abuse of discretion, or otherwise not in accordance with\\r\\nlaw.\\u201D 5 U.S.C. \\u00A7 706(2)(A).\\r\\n98. The AEA requires that noncitizens whose removal is authorized by the AEA,\\r\\nunless \\u201Cchargeable with actual hostility, or other crime against the public safety,\\u201D be allowed the\\r\\nfull time stipulated by treaty to depart or a reasonable time in which to settle their affairs before\\r\\ndeparting. See 50 U.S.C. \\u00A7 22. The Proclamation on its face denies Plaintiffs any time under\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 21 of 24\\r\\n20\\r\\nSection 22 to settle their affairs, because it declares everyone subject to the Proclamation to be\\r\\n\\u201Cchargeable with actual hostility\\u201D and to be a \\u201Cdanger to public safety.\\u201D\\r\\n99. The AEA Process thus contravenes 50 U.S.C. \\u00A7 22 and is ultra vires.\\r\\n100. The application of the AEA Process to Plaintiffs is contrary to law. EIGHTH\\r\\nCLAIM FOR RELIEF\\r\\nViolation of Due Process Under the Fifth Amendment\\r\\n(All Defendants)\\r\\n101. All of the foregoing allegations are repeated and realleged as if fully set forth\\r\\nherein.\\r\\n102. The Due Process Clause of the Fifth Amendment provides in relevant part that:\\r\\n\\u201CNo person shall be deprived of life, liberty, or property, without due process of law.\\u201D U.S.\\r\\nConst. amend. V.\\r\\n103. In denying Plaintiffs meaningful procedural protections to challenge their\\r\\nremoval, the Proclamation violates due process.\\r\\n104. The Proclamation on its face also denies Plaintiffs any time to settle their affairs\\r\\nbefore departing and thus violates the due process.\\r\\nNINTH CLAIM FOR RELIEF\\r\\nViolation of Habeas Corpus\\r\\n(All Defendants)\\r\\n105. Detainees have the right to file petitions for habeas corpus to challenge the\\r\\nlegality of their detention or raise other claims related to their detention or to the basis for their\\r\\nremoval.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 22 of 24\\r\\n21\\r\\n106. The detention of Plaintiffs under the Alien Enemies Act has violated and\\r\\ncontinues to violate their right to habeas corpus. See U.S. Const. art. I, \\u00A7 9, cl. 2 (Suspension\\r\\nClause); 28 U.S.C. \\u00A7 2241.\\r\\nPRAYER FOR RELIEF\\r\\nWHEREFORE, Plaintiffs respectfully pray this Court to:\\r\\na. Issue permanent injunctive relief prohibiting Defendants from removing Plaintiffs\\r\\npursuant to the Alien Enemies Act Proclamation;\\r\\nb. Grant a temporary restraining order to preserve the status quo pending further\\r\\nproceedings;\\r\\nc. Declare unlawful the AEA Process;\\r\\nd. Enter an order enjoining Defendants from applying the AEA Process;\\r\\ne. Enter an order providing relief by ordering that Defendants to stay their removals under\\r\\nthe Proclamation and remove anyone subject to the Proclamation from the AEA Process;\\r\\nf. Grant a writ of habeas corpus to Plaintiffs that enjoins Defendants from removing them\\r\\nunder the AEA,\\r\\ng. Award Plaintiffs\\u2019 counsel reasonable attorneys\\u2019 fees under the Equal Access to Justice\\r\\nAct, and any other applicable statute or regulation; and\\r\\nh. Grant such further relief as the Court deems just, equitable, and appropriate.\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 23 of 24\\r\\n22\\r\\nDated: March 15, 2025\\r\\nNoelle Smith*\\r\\nOscar Sarabia Roman*\\r\\nAMERICAN CIVIL LIBERTIES UNION\\r\\nFOUNDATION\\r\\n425 California Street, Suite 700\\r\\nSan Francisco, CA 94104\\r\\n(415) 343-0770\\r\\nnsmith@aclu.org\\r\\nosarabia@aclu.org\\r\\nArthur B. Spitzer (D.C. Bar No. 235960)\\r\\nScott Michelman (D.C. Bar No. 1006945)\\r\\nAMERICAN CIVIL LIBERTIES UNION\\r\\nFOUNDATION OF THE DISTRICT OF\\r\\nCOLUMBIA\\r\\n529 14th Street, NW, Suite 722\\r\\nWashington, D.C. 20045\\r\\n(202) 457-0800\\r\\naspitzer@acludc.org\\r\\nsmichelman@acludc.org\\r\\nRespectfully submitted,\\r\\n\\\/s\\\/ Lee Gelernt\\r\\nLee Gelernt (D.D.C. Bar No. NY0408)\\r\\nDaniel Galindo (D.D.C. Bar No. NY035)\\r\\nAshley Gorski*\\r\\nOmar C. Jadwat*\\r\\nHina Shamsi (D.D.C. Bar No. MI0071)\\r\\nPatrick Toomey*\\r\\nSidra Mahfooz*\\r\\nAMERICAN CIVIL LIBERTIES UNION\\r\\nFOUNDATION,\\r\\n125 Broad Street, 18th Floor\\r\\nNew York, NY 10004\\r\\n(212) 549-2660\\r\\nlgelernt@aclu.org\\r\\ndgalindo@aclu.org\\r\\nagorski@aclu.org\\r\\nojadwat@aclu.org\\r\\nhshamsi@aclu.org\\r\\nptoomey@aclu.org\\r\\nsmahfooz@aclu.org\\r\\nSomil B. Trivedi (D.C. Bar No. 1617967)\\r\\nBradley Girard (D.C. Bar No. 1033743)\\r\\nMichael Waldman (D.C. Bar No. 414646)\\r\\nSarah Rich*\\r\\nSkye Perryman (D.C. Bar No. 984573)\\r\\nDEMOCRACY FORWARD\\r\\nFOUNDATION\\r\\nP.O. Box 34553\\r\\nWashington, DC 20043\\r\\nPhone: (202) 448-9090\\r\\nFax: (202) 796-4426\\r\\nstrivedi@democracyforward.org\\r\\nbgirard@democracyforward.org\\r\\nmwaldman@democracyforward.org\\r\\nsrich@democracyforward.org\\r\\nsperryman@democracyforward.org\\r\\nAttorneys for Plaintiffs-Petitioners\\r\\n*Pro bono representation certificates or\\r\\nPro hac vice motions forthcoming\\r\\nCase 1:25-cv-00766-JEB Document 1 Filed 03\\\/15\\\/25 Page 24 of 24\\r\\n\\r\\n============= \\r\\nMotion for a temporary restraining order (TRO) \\r\\n=============\\r\\n\\r\\n1\\r\\nIN THE UNITED STATES DISTRICT COURT\\r\\nFOR THE DISTRICT OF COLUMBIA\\r\\nJ.G.G., et al.,\\r\\nPlaintiffs\\u2013Petitioners,\\r\\nv.\\r\\nDONALD J. TRUMP, in his official capacity as\\r\\nPresident of the United States, et al.,\\r\\nDefendants\\u2013Respondents.\\r\\nCase No: 1-25-00766\\r\\nEMERGENCY APPLICATION FOR A TEMPORARY RESTRAINING ORDER\\r\\nPlaintiffs and the proposed class are imminent danger of being removed tonight or early\\r\\ntomorrow morning under the Alien Enemies Act\\u2014and this Court permanently losing jurisdiction.\\r\\nPursuant to Rule 65 of the Federal Rules of Civil Procedure, and the All Writs Act, Plaintiffs-\\r\\nPetitioners and the proposed class hereby apply for a temporary restraining order against Defendants-\\r\\nRespondents (\\u201CDefendants\\u201D). Plaintiffs are civil immigration detainees who are at substantial risk of\\r\\nimmediate, summary removal from the United States pursuant to use of the Alien Enemies Act, 50 U.S.C.\\r\\n\\u00A7 21 et seq. against a non-state actor for the first time in the country\\u2019s history.\\r\\nAs set forth in the accompanying Memorandum of Law, Defendants\\u2019 invocation and application\\r\\nof the Alien Enemies Act patently violates the plain text of the statute and exceeds the limited authority\\r\\ngranted to the Executive Branch by Congress. Defendants\\u2019 invocation and application of the Alien\\r\\nEnemies Act also violates the Immigration and Nationality Act, statutes providing protection for people\\r\\nseeking humanitarian relief, and due process. In the absence of a temporary restraining order, Plaintiffs\\r\\nwill suffer irreparable injury, and the balance of hardships and the public interest favor relief. Critically,\\r\\nmoreover, if Plaintiffs are removed to the custody of another country, this Court will lose jurisdiction.\\r\\nIn support of this Motion, Plaintiffs rely upon the accompanying memorandum in support of a\\r\\nCase 1:25-cv-00766 Document 3 Filed 03\\\/15\\\/25 Page 1 of 3\\r\\n2\\r\\nTemporary Restraining Order, declarations, and motion and memorandum for class certification. A\\r\\nproposed order is attached for the Court\\u2019s convenience. Plaintiffs respectfully request that this Court grant\\r\\nthis emergency application and issue a temporary restraining order tonight.\\r\\nDated: March 15, 2025\\r\\nNoelle Smith*\\r\\nOscar Sarabia Roman*\\r\\nAMERICAN CIVIL LIBERTIES UNION\\r\\nFOUNDATION\\r\\n425 California Street, Suite 700\\r\\nSan Francisco, CA 94104\\r\\n(415) 343-0770\\r\\nnsmith@aclu.org\\r\\nosarabia@aclu.org\\r\\nArthur B. Spitzer (D.C. Bar No. 235960)\\r\\nScott Michelman (D.C. Bar No. 1006945)\\r\\nAMERICAN CIVIL LIBERTIES UNION\\r\\nFOUNDATION OF THE DISTRICT OF\\r\\nCOLUMBIA\\r\\n529 14th Street, NW, Suite 722\\r\\nWashington, D.C. 20045\\r\\n(202) 457-0800\\r\\naspitzer@acludc.org\\r\\nsmichelman@acludc.org\\r\\nRespectfully submitted,\\r\\n\\\/s\\\/ Lee Gelernt\\r\\nLee Gelernt (D.D.C. Bar No. NY0408)\\r\\nDaniel Galindo (D.D.C. Bar No. NY035)\\r\\nAshley Gorski*\\r\\nOmar C. Jadwat*\\r\\nHina Shamsi (D.D.C. Bar No. MI0071)\\r\\nPatrick Toomey*\\r\\nSidra Mahfooz*\\r\\nAMERICAN CIVIL LIBERTIES UNION\\r\\nFOUNDATION,\\r\\n125 Broad Street, 18th Floor\\r\\nNew York, NY 10004\\r\\n(212) 549-2660\\r\\nlgelernt@aclu.org\\r\\ndgalindo@aclu.org\\r\\nagorski@aclu.org\\r\\nojadwat@aclu.org\\r\\nhshamsi@aclu.org\\r\\nptoomey@aclu.org\\r\\nsmahfooz@aclu.org\\r\\nSomil B. Trivedi (D.C. Bar No. 1617967)\\r\\nBradley Girard (D.C. Bar No. 1033743)\\r\\nMichael Waldman (D.C. Bar No. 414646)\\r\\nSarah Rich*\\r\\nSkye Perryman (D.C. Bar No. 984573)\\r\\nDEMOCRACY FORWARD\\r\\nFOUNDATION\\r\\nP.O. Box 34553\\r\\nWashington, DC 20043\\r\\nPhone: (202) 448-9090\\r\\nFax: (202) 796-4426\\r\\nstrivedi@democracyforward.org\\r\\nbgirard@democracyforward.org\\r\\nmwaldman@democracyforward.org\\r\\nsrich@democracyforward.org\\r\\nsperryman@democracyforward.org\\r\\nCase 1:25-cv-00766 Document 3 Filed 03\\\/15\\\/25 Page 2 of 3\\r\\n3\\r\\nAttorneys for Plaintiffs-Petitioners\\r\\n*Pro bono representation certificates or\\r\\nPro hac vice motions forthcoming\\r\\nCase 1:25-cv-00766 Document 3 Filed 03\\\/15\\\/25 Page 3 of 3\\r\\n\\r\\n============= \\r\\nPartial transcript of an emergency hearing relating to the TRO\\r\\n=============\\r\\n\\r\\n1\\r\\n    UNITED STATES DISTRICT COURT\\r\\nFOR THE DISTRICT OF J.G.G., et al.,\\r\\nPlaintiff(s),\\r\\nv.\\r\\nDONALD J. TRUMP, et al.,\\r\\nCOLUMBIA\\r\\nCivil Case\\r\\nNo. 25-00766 JEB\\r\\nWashington, D.C. March 15, 2025\\r\\nDefendant(s). ----------------------------------------------------------\\r\\nMOTION HEARING HELD VIA ZOOM BEFORE THE HONORABLE JAMES E. BOASBERG UNITED STATES DISTRICT CHIEF JUDGE\\r\\nAPPEARANCES:\\r\\nFOR THE PLAINTIFF(S):\\r\\nLee Gelernt, Esquire\\r\\nDaniel A. Galindo, Esquire American Civil Liberties Union 125 Broad Street\\r\\n18th Floor\\r\\nNew York, New York 10004\\r\\nSkye Perryman, Esquire Somil Trivedi, Esquire Sarah Rich, Esquire Democracy Forward Foundation P.O. Box 34533\\r\\nWashington, D.C. 20043\\r\\nDrew C. Ensign, Esquire\\r\\nUnited States Department of Justice 950 Pennsylvania Avenue Northwest Washington, D.C. 20530\\r\\nTammy Nestor, RMR, CRR\\r\\nOfficial Court Reporter\\r\\n333 Constitution Avenue Northwest Washington, D.C. 20001 tammy_nestor@dcd.uscourts.gov\\r\\nFOR THE DEFENDANT(S):\\r\\nREPORTED BY:\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n2\\r\\n           The following proceedings began at 5:00 p.m.:\\r\\n       THE COURTROOM DEPUTY:  We are here today for a motion\\r\\nhearing in Civil Action 25-766, JGG, et al. versus President\\r\\nDonald Trump, et al.\\r\\n       Beginning with counsel for the plaintiff, please\\r\\nstate your name for the record.\\r\\n       MR. GELERNT:  Good afternoon, Your Honor.  Lee\\r\\nGelernt for the plaintiffs from the ACLU.\\r\\n       THE COURT:  Good afternoon.\\r\\n       MR. GALINDO:  Good afternoon, Your Honor.  Daniel\\r\\nGalindo for the plaintiffs from the ACLU.\\r\\n       THE COURT:  Thank you.\\r\\n       MS. PERRYMAN:  Good afternoon, Your Honor.  Skye\\r\\nPerryman for the plaintiffs from Democracy Forward\\r\\nFoundation.\\r\\n       THE COURT:  Welcome.\\r\\n       MR. TRIVEDI:  Somil Trivedi from the Democracy\\r\\nForward Foundation for the plaintiffs.\\r\\n       THE COURT:  Thank you.\\r\\n       MS. RICH:  Good afternoon, Your Honor.  Sarah Rich\\r\\nfor the plaintiffs, also from Democracy Forward Foundation.\\r\\n       THE COURT:  Thank you.  Nice to see all of you.\\r\\n       THE COURTROOM DEPUTY:  Okay.  And defense?\\r\\n       MR. ENSIGN:  Good afternoon, Your Honor.  Drew Ensign\\r\\nfor the federal defendants.\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n3\\r\\n           THE COURT:  Thanks, Mr. Ensign.\\r\\n       Okay.  So first, apologies for my attire.  I went\\r\\naway for the weekend and brought with me neither a robe nor\\r\\ntie nor appropriate shirt, so thank you all for being\\r\\nappropriately attired and hope you will forgive my casual\\r\\nones.\\r\\n       Thanks also for everybody's availability on such\\r\\nshort notice.  Again, I only learned of this case first\\r\\nthing this morning, and I know everybody has been working\\r\\nhard to get up to speed on it since that time.\\r\\n       So I have a few -- just a couple preliminary points\\r\\nand questions, and then we will move forward.\\r\\n       So the first is I was told first thing this morning\\r\\nthat at least one of the named plaintiffs was at that point\\r\\nbeing placed on a plane or imminently being placed on a\\r\\nplane to be deported, and my ruling this morning was,\\r\\nbecause I was not aware of the issuance of any proclamation\\r\\nand I don't think one had been issued at the time I ruled,\\r\\nmy ruling was based on my belief that under the INA, there\\r\\nwas no authority to immediately deport folks who were named\\r\\nplaintiffs.\\r\\n       So my ruling was not a preventive ruling related to\\r\\nthe AEA because I didn't believe it had been -- there had\\r\\nbeen a proclamation at that time.  I now see that there has\\r\\nbeen a proclamation issued.\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n4\\r\\n           Mr. Ensign, do you have a time of day that that was\\r\\nissued you can put on the record?\\r\\n       MR. ENSIGN:  I do not, Your Honor.  We are happy to\\r\\nlook into that and get back to you.  I know it was just put\\r\\non the presidential website about an hour ago.\\r\\n       THE COURT:  But fair to say this afternoon?\\r\\n       MR. ENSIGN:  Your Honor, I don't know the answer to\\r\\nthat question.\\r\\n       THE COURT:  Okay.\\r\\n       MR. GELERNT:  Your Honor, I apologize for\\r\\ninterrupting.  This is Mr. Gelernt.  My understanding from\\r\\nthe proclamation is that it was signed yesterday.  It may\\r\\nnot have been made public until today, but that it was\\r\\nsigned and, I guess, kept secret until today.\\r\\n       THE COURT:  It's an interesting question of when it\\r\\nis effective if it's not published.  Thank you for that.\\r\\nBut just making clear that my ruling was INA-based this\\r\\nmorning.\\r\\n       Okay.  The second question which I think the\\r\\nplaintiffs have raised in alerting my chambers to the\\r\\nproclamation is that they expected planes to be departing\\r\\nwithin the last couple of hours.\\r\\n       And so I will ask you, Mr. Ensign, if any of the\\r\\nnamed plaintiffs are, in fact, on any plane that has\\r\\ndeparted?\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n5\\r\\n           MR. ENSIGN: Your Honor, we have confirmed with the\\r\\ndefendants that removal to Guantanamo Bay had been initiated\\r\\nunder the AEA, later changed to El Salvador. However, these\\r\\nfive named plaintiffs subject to the TRO will not be removed\\r\\nduring that 14-day period.\\r\\nTHE COURT: Okay. But then I would assume that means that they are either not on the planes or that they will not be removed from the planes and will be brought back once the planes land in El Salvador. Is that fair?\\r\\n       MR. ENSIGN:  Your Honor, I don't know the status of\\r\\nthe planes.  If there are removal flights, the five would not\\r\\nbe on them.\\r\\nTHE COURT: Okay. I'm sorry. Was it not six,\\r\\nMr. Gelernt?\\r\\nMR. GELERNT: It was five, Your Honor.\\r\\nTHE COURT: Sorry. Okay. All right. So thank you,\\r\\nMr. Ensign.\\r\\n       And I also understand just from looking at the docket\\r\\nthat the government has appealed my TRO ruling.  And that's\\r\\nobviously your right, Mr. Ensign.  So I won't go into,\\r\\nbecause I don't think I have jurisdiction given the appeal,\\r\\nto reargue the TRO ruling, but what we will just look at\\r\\ntoday is the class question.  And then if I do, in fact,\\r\\ncertify provisionally, then we can talk.\\r\\nI think what that would likely mean is that the\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n6\\r\\n           plaintiffs could then seek a TRO on behalf of a\\r\\ncertified class, and then we can talk about how we want to\\r\\ngo from there.  I think we are having an echo.\\r\\n       THE COURTROOM DEPUTY:  It is.  I am having difficulty\\r\\nwith the public line.  It may be too many people on here.\\r\\nI'll keep it as long as I can, Your Honor.\\r\\n       THE COURT:  Okay.  Thank you.\\r\\n       So let me ask the government then what your position\\r\\nis regarding the class issue only.\\r\\n       MR. ENSIGN:  Your Honor, we oppose class\\r\\ncertification.  The principal reason is one of venue and\\r\\nauthority.  Under -- I think we are getting the echo again.\\r\\nTHE COURT: We are, but let's try to go ahead, and as annoying as it is, let's see if we can push through with the echo.\\r\\n        MR. ENSIGN:  Thank you, Your Honor.  Will do.\\r\\n       These are claims that plaintiffs have brought that\\r\\nfundamentally sound in habeas.  When the supreme court\\r\\nconsidered the last AEA case in Ludecke versus Watkins, 355\\r\\nU.S. 160, these were all considered within the scope of\\r\\nhabeas.  And because this is a habeas case, because it\\r\\nsounds in habeas and because plaintiffs have specifically\\r\\nincluded a habeas claim, I believe it's Count 9 of their\\r\\ncomplaint, then the venue rules of habeas apply.\\r\\n       Under the supreme court decision in Rumsfeld v.\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n7\\r\\n    Padilla, venue was only appropriate for a habeas case solely\\r\\nin the location where the person is being detained or where\\r\\n(unintelligible), and so because of that --\\r\\n       (There was an interruption by the court reporter.)\\r\\n       THE COURT:  Sorry, Tammy, the court reporter.\\r\\n       I think when there's an echo, I think you might have\\r\\nto sort of proceed sentence by sentence and pause and let\\r\\nthe echo go through and then continue.\\r\\n       And, Tammy, we'll hope that will be satisfactory.\\r\\n       So, Mr. Ensign, again, the issue is venue.  You are\\r\\nsaying that it must be brought where the warden or the --\\r\\ntypically prisoner cases, it's the warden, but here, whoever\\r\\nis actually detaining the plaintiffs.  Is that correct?\\r\\n       MR. ENSIGN:  That's correct, Your Honor.  In\\r\\naddition, this Court has recognized, and I believe Your\\r\\nHonor in the Vetre versus Sessions case, which is\\r\\n316 F. Supp. 70, that when habeas is available, then that is\\r\\nan -- that's an adequate alternative remedy that precludes\\r\\nAPA claims under Section 702, and so all the claims would\\r\\nhave to be considered under habeas.\\r\\n       And because of that, you know, to the extent that\\r\\nthere could ever be a class, it could only be solely within\\r\\na single judicial district of people there.  And of course,\\r\\nit would still have to satisfy all the other requirements of\\r\\nclasses, but certainly that venue issue precludes this Court\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n8\\r\\n    certifying a nationwide class.\\r\\n       THE COURT:  Okay.  Thank you very much.\\r\\n       Mr. Gelernt, can you respond to the venue question?\\r\\n       MR. GELERNT:  Sure, Your Honor.  I think initially --\\r\\nI guess I don't have an echo, so I can continue.\\r\\n       Initially we have -- we think this conflates the\\r\\nmerits.  And you know, you issued a TRO.  You found you had\\r\\njurisdiction to issue a TRO.  So we think that's sufficient\\r\\nat this point.  I think we are veering pretty far into the\\r\\nmerits.\\r\\n       But just taking it on those terms, for one thing, we\\r\\nfiled both a habeas and APA 1331.  And you can challenge the\\r\\nEnemy Aliens Act without habeas.  There are cases like Clark\\r\\nthat do that.  But also, for habeas, I would also say that\\r\\nthe immediate custodian rule does not apply because this is\\r\\nnot core habeas asking for relief.  It's to stop the\\r\\ntransfer and challenge the constitutionality.\\r\\n       So both because we haven non-habeas fonds of\\r\\njurisdiction and because the immediate custodian rule\\r\\ndoesn't immediately apply in this case, I think that's more\\r\\nthan sufficient for this Court to proceed.\\r\\n       THE COURT:  So, Mr. Ensign, Mr. Gelernt is right that\\r\\nthey are not seeking release, so tell me why you think your\\r\\nvenue argument is still appropriate.\\r\\nMR. ENSIGN:  Your Honor, because these claims\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n9\\r\\n    inherently sound in habeas.  Plaintiffs recognize that\\r\\nthemselves by bringing a habeas case.  The supreme court\\r\\nitself has recognized that it's appropriate to consider this\\r\\nin habeas when it did so in the Ludecke case.\\r\\n       And where habeas applies, it displaces a lot of other\\r\\nlaw including specifically the APA, as this court found in\\r\\nthe Vetre case.  It also displaces even statutory causes of\\r\\naction.  You know, Heck v. Humphrey, for example, even\\r\\nthough you would otherwise have a 1983 suit for most\\r\\nconstitutional claims, the second they sound in habeas,\\r\\nhabeas, you know, cuts off 1983 entirely and forces you to\\r\\ngo through the route of habeas.\\r\\n       And so the habeas rule has some real teeth and is\\r\\nultimately an attack on the authority of wardens to turn\\r\\npeople over, you know, to be removed, and they would -- I\\r\\nmean, what they are seeking ultimately is the equivalent to\\r\\ntelling the immigration, equivalent to a warden, you may not\\r\\nrelease these people to be removed from the country.\\r\\n       THE COURT:  Isn't that the exact opposite of habeas\\r\\nwhere you just said you are ordering them you may not be\\r\\nreleased as opposed to habeas which is you must be released,\\r\\nright?\\r\\n       MR. ENSIGN:  Your Honor, it is -- in this\\r\\napplication, it is a little odd, but certainly the way the\\r\\nsupreme court has considered it previously, like,\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n10\\r\\n    specifically challenges to the AEA sounded in habeas.  And\\r\\nthat was an utterly uncontroversial aspect of the Ludecke\\r\\ndecision.  Even though it was five-four about, you know, the\\r\\nintricacies of the AEA, it nonetheless was uncontroversial\\r\\nthere that this was properly heard as a habeas claim.\\r\\n       THE COURT:  Do you want to respond to that,\\r\\nMr. Gelernt?\\r\\n       MR. GELERNT:  Your Honor, I would just say that the\\r\\nfact that some cases can be brought in habeas certainly\\r\\ndoesn't preclude them being brought under 1331 and the APA\\r\\nand this court.  And Your Honor has opinions along those\\r\\nlines with detainees outside of the district in Damus and I\\r\\nthink Heredia Mons as well.\\r\\n       As Your Honor said, this is not a core habeas.  We\\r\\ncertainly can proceed in habeas in this district, but we\\r\\ndon't need to proceed in habeas.  We are not aware of any\\r\\ncase that says we cannot challenge the Alien Enemies Act on\\r\\nnon-habeas grounds.\\r\\n       THE COURT:  All right.  Well, this is obviously an\\r\\nissue that has not been briefed.\\r\\n       I should have said earlier at the beginning of the\\r\\nhearing, although it is implicit, that there is no\\r\\nbroadcasting or recording of this hearing, and I am being\\r\\ninformed that it is, in fact, being broadcast by a certain\\r\\nindividual.  That's in violation of the court's rules.  That\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n11\\r\\n    can be punishable by contempt.  You may not broadcast or\\r\\nrecord any court proceedings.  And further -- I am getting\\r\\nfurther information we will shut down the public line.\\r\\n       THE COURTROOM DEPUTY:  Your Honor, I did make that\\r\\nstatement.\\r\\n       THE COURT:  Thank you.\\r\\n       THE COURTROOM DEPUTY:  You're welcome.\\r\\n       THE COURT:  So I think it would be very helpful for\\r\\nme to get some expedited briefing on this.  And I know that\\r\\ngiven the circumstances, the plaintiffs are justifiably\\r\\nconcerned about imminent deportation.\\r\\n       Can you tell us, Mr. Ensign, are imminent\\r\\ndeportations and removals under this proclamation planned?\\r\\nWhen I say imminent, I mean in the next 24 or 48 hours.\\r\\n       MR. ENSIGN:  Your Honor, I don't know the answer to\\r\\nthat question.  We can certainly investigate that and report\\r\\nthat back to you.  But I don't know that -- the answer to\\r\\nthat.  I know what plaintiffs have said to the clerk's\\r\\noffice.  I don't yet know -- have an ability to confirm that\\r\\nor, you know, contest that.\\r\\n       THE COURT:  Okay.  So how soon can you get that\\r\\ninformation?\\r\\n       MR. ENSIGN:  Your Honor, I can certainly talk to them\\r\\nASAP and see.  You know, it is Saturday.  I will try to get\\r\\npeople as quickly as possible and find out that information.\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n12\\r\\n    You know, I think we were certainly planning on opposing the\\r\\nTRO by tomorrow night in advance of the hearing on Monday if\\r\\nthat's still going forward.  We can certainly include it in\\r\\nthat filing if that works.\\r\\n       THE COURT:  So, Mr. Gelernt, do you want to propose a\\r\\nschedule for me?  I think I would like the -- we should\\r\\nprobably have the government first respond saying there\\r\\nis -- arguing just on the venue issue of class\\r\\ncertification, and then you can respond to that and I would\\r\\nrule quickly.\\r\\n       MR. GELERNT:  Your Honor, a couple of things.  One is\\r\\nthat I recognize it's Saturday, but on the other hand, the\\r\\ngovernment appears to be moving planes very rapidly to\\r\\nEl Salvador with hundreds of people.  So we hope that in the\\r\\nnext five minutes, counsel for the government can get an\\r\\nanswer to that.\\r\\n       Our understanding from people on the ground, from\\r\\ndifferent sources, is that planes are going right now taking\\r\\nVenezuelans to El Salvador and may be ending up in a\\r\\nSalvadoran prison.  Not only will that divest this Court of\\r\\njurisdiction, but I think those people are in real trouble,\\r\\nVenezuelans put into a Salvadoran prison.\\r\\n       So we had two flights that we believe were scheduled\\r\\nfor this afternoon that may have already taken off or during\\r\\nthis hearing, so I think in the next five minutes.\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n13\\r\\n           And we would further ask Your Honor that you issue a\\r\\nclass-wide TRO pending the briefing, and we will be prepared\\r\\nto get the venue briefing in as soon as the government can\\r\\ndo it and you would like.  But I think there is so much\\r\\nurgency here and there is so much harm at stake and this\\r\\nCourt's jurisdiction is at stake.\\r\\n       And just one clarification, Your Honor, we don't\\r\\nbelieve we would need to amend the TRO because the TRO did\\r\\nask for a class-wide TRO.  The complaint was a class\\r\\ncomplaint.  We have class papers, and the TRO was seeking a\\r\\nclass TRO.\\r\\n       So we would respectfully urge this Court to issue a\\r\\nclass TRO now to avoid any more harm and then brief the\\r\\nvenue as fast as the government would like.  And we would\\r\\nrespond in eight hours or so or ten hours or whatever the\\r\\nCourt thinks is appropriate.\\r\\n       THE COURT:  I think it would probably be helpful if\\r\\nwe adjourned this hearing briefly and let Mr. Ensign do some\\r\\ndigging and then returned and talked about this further.  So\\r\\nwhy don't we -- can we adjourn this hearing until\\r\\n6:00 Eastern Time, at which time, Mr. Ensign, I will want to\\r\\nknow, have planes, in fact -- is deportation of people under\\r\\nthe proclamation pursuant to the AEA in motion now and will\\r\\nit be for the next 48 hours, because that would require a\\r\\nmore immediate decision.  All right, Mr. Ensign?\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n14\\r\\n           MR. ENSIGN:  We can do that, Your Honor.  I mean,\\r\\nbriefly on the irreparable harm point, as the supreme court\\r\\nsaid in Nken, Although removal is a serious burden for many\\r\\naliens, it's not categorically irreparable as some courts\\r\\nhave said.  It is accordingly plain that the burden of\\r\\nremoval alone cannot constitute the requisite irreparable\\r\\ninjury.\\r\\n       THE COURT:  I think they have made out more than just\\r\\nremoval.  I think they have made out the harm that will\\r\\nbefall the individual plaintiffs upon removal.\\r\\n       So what we will do is we will adjourn the hearing\\r\\nuntil 6:00 p.m. Eastern Time.  We will resume the hearing at\\r\\nthat point and get information from Mr. Ensign, and then I\\r\\nwill also try to have a better sense of whether I am\\r\\nprepared to -- again, it could be issuing a separate TRO\\r\\ncovering this provisional class or not.\\r\\n       Okay.  Any objection to that, Mr. Gelernt?\\r\\n       MR. GELERNT:  No, Your Honor.  Thank you.\\r\\n       THE COURT:  Good.\\r\\n       Mr. Ensign?\\r\\n       MR. ENSIGN:  No, Your Honor.  We will proceed as you\\r\\ninstruct.\\r\\n       THE COURT:  Okay.  See everybody in 38 minutes.\\r\\nThanks.\\r\\nTHE COURTROOM DEPUTY:  This honorable court is\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n15\\r\\n    adjourned until 6:00 p.m.\\r\\n       (The hearing adjourned at 5:22 p.m.)\\r\\n       THE COURT:  Thanks, Nikki.\\r\\n       Welcome back, everybody.  I don't think we need to\\r\\nhave everyone identify themselves again.  I've got the same\\r\\ncounsel present.\\r\\n       Mr. Ensign, let's hear your report.\\r\\n       MR. ENSIGN:  Your Honor, unfortunately I don't have\\r\\nmany details to share.  I have talked to the clients who let\\r\\nme know the sort of operational details as to what is going\\r\\non with raised potential national security issues,\\r\\nparticularly ones if discussed with a public line.  So I do\\r\\nnot have additional details I can provide at this time.\\r\\nThey raised that we may be able to provide Your Honor additional details in an in camera hearing if we were to -- THE COURT: Fine. Maybe what we should do -- Nikki, can we either disconnect the public line, or can you put us\\r\\nin breakout rooms?  Can we disconnect and then reconnect the\\r\\npublic line, or can we go into a breakout room?\\r\\n       THE COURTROOM DEPUTY:  I can just remove the public\\r\\nline right now.\\r\\n       THE COURT:  And then can you reinstate it?\\r\\n       THE COURTROOM DEPUTY:  I believe so.  If it\\r\\ndisconnects, I can call it without interrupting as well.\\r\\nIt's different than the courtroom.\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n16\\r\\n    THE COURT: Okay. So we are going to disconnect the public line for this in camera proceeding, and then we will come back.\\r\\n       (The public line was disconnected.)\\r\\n       THE COURT:  Okay.  The public line is\\r\\n       disconnected. Mr. Ensign.\\r\\n       MR. ENSIGN:  Your Honor, I am still trying to get\\r\\nadditional details.  I don't -- we would have to sort out\\r\\nwhat can still be provided in camera.  They suggested that\\r\\nas a way to potentially provide some details, but I do not\\r\\npersonally have those right now.\\r\\n       THE COURT:  So you have no details for us in camera?\\r\\n       MR. ENSIGN:  Not at this time, Your Honor.  We would\\r\\nhave to figure out what could be provided in camera.\\r\\n       THE COURT:  Okay.  Well, when is that going to be\\r\\ndetermined?\\r\\n       MR. ENSIGN:  I don't know.  I have been trying to get\\r\\nthose details, and I don't presently know when I would be\\r\\nable to get that.  I'm certainly trying to get that\\r\\ninformation, but that is not something, the details, that I\\r\\nknow.\\r\\n       MR. GELERNT:  Your Honor, I'm sorry.\\r\\n       THE COURT:  Sure.  Go ahead.\\r\\n       MR. GELERNT:  Your Honor, what we understand is that\\r\\ntwo flights went to El Salvador this afternoon, one very\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n17\\r\\n    recently, and there's another one, we are not sure where\\r\\nit's scheduled to go exactly.  It may be Honduras.  We are\\r\\nnot sure.  But it's supposed to leave at 6:23.\\r\\n       THE COURT:  All right.  Let's reconnect the public\\r\\nline.\\r\\n       THE COURT REPORTER:  Your Honor, is the in camera\\r\\nportion of the hearing under seal?\\r\\n       THE COURT:  I trust not, Mr. Ensign, since we didn't\\r\\nhear anything.  Any reason we need to put that under seal,\\r\\nMr. Ensign?\\r\\nMR. ENSIGN: No objection, Your Honor.\\r\\nTHE COURT: Okay. So no, Tammy.\\r\\n(The public line was reconnected.)\\r\\nTHE COURT: All right. It looks like it's -- is it\\r\\nback up, Nikki?\\r\\nTHE COURTROOM DEPUTY: Yes, Your Honor.\\r\\nTHE COURT: Okay. So for the public, there were no\\r\\nrepresentations that were able to be made in our private\\r\\nsession, so the public has not missed anything.\\r\\nAll right. So, Mr. Gelernt, why don't you just repeat your statement.\\r\\n       MR. GELERNT:  We understand that two flights went to\\r\\nEl Salvador this afternoon; one very recently, and then\\r\\nanother flight is scheduled for 6:23, we believe, to\\r\\nHonduras, but we are not entirely sure.  And the flight\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n18\\r\\n    destinations have changed for these past two flights. But we believe it's scheduled for 6:23, so only in a matter of minutes.\\r\\n       THE COURT:  So, Mr. Ensign, you can't -- can you\\r\\nconfirm that people -- you can't even confirm -- well, I\\r\\nguess on the public line, you're not -- and actually\\r\\ncouldn't make any representations even privately what's\\r\\nhappening with any flights.\\r\\n       So let me just go over then a few issues that we\\r\\ndiscussed earlier.  So the first is the people who would be\\r\\nsubject to be certified as a class and then further\\r\\nrequested TRO, Mr. Gelernt, they are, as you believe, all\\r\\ncurrently held under INA?\\r\\n       MR. GELERNT:  They are all in proceedings as far as\\r\\nwe understand, and so what the government apparently is\\r\\ndoing is using the Alien Enemies Act to circumvent the\\r\\nimmigration laws and to remove them before they actually\\r\\nhave a final order.  That's the case with the five\\r\\nplaintiffs, and that's what we understand to be happening\\r\\naround the country.\\r\\n       THE COURT:  Right, but what I'm trying to look at is\\r\\nthe venue and habeas question.\\r\\nMR. GELERNT: Right.\\r\\nTHE COURT: And so I guess -- it seems that you are\\r\\nnot seeking to challenge the fact or duration of their\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n19\\r\\n           confinement.  Is that true?\\r\\n       MR. GELERNT:  That's absolutely right, Your Honor.\\r\\nAnd I think that's the critical distinction here, that it's\\r\\nnot a core habeas challenging release.  They are not trying\\r\\nto get out of detention in this lawsuit.  They are going to\\r\\nbe held in detention presumably unless they have some\\r\\nindividual basis under the INA to get out.  This lawsuit\\r\\nwill not allow them to be released, but it will stop their\\r\\nremoval hopefully under the Alien Enemies Act so they can\\r\\ncontinue their proceedings under the immigration law.  So\\r\\nit's absolutely not a core habeas.\\r\\nTHE COURT: So --\\r\\nMR. GELERNT: I apologize, Your Honor. I was just going to add the point --\\r\\n       THE COURT:  Go ahead.\\r\\nMR. GELERNT: -- even if it could be brought in habeas, that doesn't mean it has to be. So your decision in RILR makes that point, Araceli. There's a number of cases in this district. You made the point very clearly in your IRLR decision that even if it could be brought in habeas, it doesn't have to be.\\r\\n       THE COURT:  Mr. Ensign, why do you think then that\\r\\nthey are challenging the fact or duration of confinement?\\r\\n       MR. ENSIGN:  Your Honor, I think that this sounds in\\r\\nhabeas for several reasons.  I think one is that because the\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n20\\r\\n    AEA vests all its authority, relevant authority, with the\\r\\npresident himself and the APA can't be used to challenge\\r\\npresidential actions, the only claims that we are left with\\r\\nhere are habeas claims.\\r\\n       We think the supreme court's decision in the 1948\\r\\ncase in Ludecke also indicates that this is a habeas case.\\r\\nAnd it's ultimately challenging, you know, the exercise of\\r\\nthe authority over their person under the AEA in a way that\\r\\nhas been recognized to sound in habeas previously.\\r\\n       But on top of all those things, we think that even if\\r\\n wasn't core habeas, it would still be subject to the habeas\\r\\nrule. Notably this court in the Vetre case --\\r\\nTHE COURT: You keep saying this court, and I don't\\r\\nthink you mean me. Do you?\\r\\nMR. ENSIGN: I actually do, Your Honor.\\r\\nTHE COURT: Okay. So the 316 F. Supp. 70? MR. ENSIGN: Yes. 316 F. Supp. 3d.\\r\\n       THE COURT:  Right.  So I'm saying that F. Supp.\\r\\npredates my time here.  Okay.  Sorry.  Go ahead.\\r\\nMR. ENSIGN: I apologize, Your Honor. Of course when I mean the court, I mean the district for the District of Columbia.\\r\\n       THE COURT:  Right, which I'm not bound by.  So if you\\r\\nwill distinguish, I try to do that in my opinions, if you\\r\\nwould be so kind.\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n21\\r\\n           MR. ENSIGN:  Absolutely, Your Honor.  In the Vetre\\r\\ncase, there were non-core habeas claims including\\r\\nconditions.  And in that case, this court recognized, this\\r\\nwas in a somewhat odd posture, that within DDC, that because\\r\\nprison condition cases could be brought in habeas, they had\\r\\nto be.  And so similarly, because these claims can be\\r\\nbrought in habeas, they have to be.\\r\\n       THE COURT:  The prison condition cases, again, relate\\r\\nto the nature of confinement and duration of your\\r\\nconfinement.  And here, they are not arguing that they can't\\r\\nbe confined.  They are just saying they can't be removed,\\r\\nright?\\r\\n       MR. ENSIGN:  Your Honor, we are using it to address\\r\\nwhether this is core or non-core.  In Vetre, a non-core\\r\\nhabeas claim was transferred under the venue rule.  So\\r\\nwhether this is core habeas, as we have argued, and clearly\\r\\nwhere the venue rule would apply or even if this were\\r\\nnon-core habeas, then nonetheless the venue rule still\\r\\napplies to it as this court has recognized.\\r\\n       MR. GELERNT:  Your Honor, I would just say that that\\r\\ncase involved, I think you were getting at this, but the\\r\\nlength of someone's confinement.\\r\\nTHE COURT: Again, I have not gone back and reviewed that case because your citation earlier, Mr. Ensign, led me to believe it was not my case. I know IRLR is.\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n22\\r\\n           I guess your -- do you want to dismiss your habeas\\r\\nclaim, Mr. Gelernt?  I don't know.  It's certainly not your\\r\\nprimary claim.  You may have other reasons for including it.\\r\\n       MR. GELERNT:  Your Honor, I think if the Court felt\\r\\nlike it needed us to dismiss the habeas in order to issue a\\r\\nclass-wide TRO, then we are prepared to do that.  We\\r\\ncertainly don't feel like we need it.\\r\\n       On the other hand, I think the Court could just hold\\r\\nit in abeyance.  I mean, I think that it's very clear that\\r\\nif you don't need to bring it in habeas, you don't have to\\r\\nand you can bring it -- in other words, I think Your Honor\\r\\ncould not have been clearer in IRLR.  There are a number of\\r\\ncases that say that.  Otherwise, virtually every case would\\r\\nbe brought in habeas.\\r\\n       THE COURT:  Again, I think this is a reasonably close\\r\\nquestion, but I've got to rule on it with essentially 40\\r\\nminutes' notice given that this was first raised by the\\r\\ngovernment in our hearing.  And I'm not blaming the\\r\\ngovernment at all because they haven't had an opportunity to\\r\\nbrief it.\\r\\n       And so as brief as my research has been at this\\r\\nperiod of time, I don't think that venue bars certification.\\r\\nI will, for clarity, I will grant the plaintiffs' -- first\\r\\ngrant the plaintiffs' motion to dismiss their habeas count.\\r\\nSo that count is dismissed without prejudice at this point.\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n23\\r\\n           But I do find that class certification is warranted\\r\\nunder Federal Rule of Civil Procedure 23(a) and 23(b)(2).\\r\\nSo I will certify a class, and the class will be -- let's\\r\\ntalk about the definition.  The plaintiffs ask for all\\r\\nnoncitizens who were, are, or will be subject to the AEA\\r\\nproclamation and its implementation.\\r\\n       So now that we actually have a proclamation that we\\r\\nhave been able to review, Mr. Gelernt, is there a reason to\\r\\nmodify that class definition?\\r\\n       MR. GELERNT:  I think certainly, Your Honor, if you\\r\\nwant to insert the name of the proclamation and the date,\\r\\nthat would be fine with us, or we could submit it to the\\r\\nCourt.  But I think, if I'm understanding you correctly, I\\r\\nthink that's what you are getting at, and that would make\\r\\nsense.\\r\\n       THE COURT:  Or if there's other -- that's one point,\\r\\nbut whether there's another modification that you would\\r\\nmake.\\r\\n       MR. GELERNT:  Yeah.\\r\\n       THE COURT:  Go ahead.\\r\\n       MR. GELERNT:  I think the other point would be that\\r\\nit seems to be the government's position that they can begin\\r\\nthese removals pursuant to the act without publicizing and\\r\\npublicize after the removals have started.  So that makes us\\r\\nvery concerned that there could be another proclamation\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n24\\r\\n    coming tomorrow naming a different gang, MS-13 or some other\\r\\ngang.\\r\\n       So I guess we could start with this one if Your Honor\\r\\nwould like to proceed more slowly, but there may be a\\r\\nmodification that could say any proclamation that names a\\r\\nnon-state actor.\\r\\nTHE COURT: Yeah, I'm just -- I appreciate that. I feel that that's going farther than I would be prepared to go as to deal with a hypothetical --\\r\\n       MR. GELERNT:  Right.\\r\\n       THE COURT:  -- proclamation.\\r\\n       MR. GELERNT:  Understood.\\r\\n       THE COURT:  So let me ask you, Mr. Ensign.  I know\\r\\nyou are objecting to the certification of the class, and\\r\\nthis is a provisional certification only, but do you have\\r\\nconcerns, if certified, with the wording, and would you\\r\\npropose amendments to that?\\r\\n       MR. ENSIGN:  Your Honor, first, just for the record,\\r\\nwe do object to the class certification, as you know.  I am\\r\\ntrying to pull up the specific language right now.\\r\\nCandidly, it's not a question I have given thought to\\r\\nbefore.\\r\\n       THE COURT:  No, I understand.  I understand.\\r\\nEverybody here is operating on the fly a bit.  I can tell\\r\\nyou what the -- I think I wrote the -- the language I wrote\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n25\\r\\n    down earlier was all noncitizens who were, are, or will be\\r\\nsubject to the AEA proclamation.\\r\\n       I mean, I think -- I don't know why -- Mr. Gelernt,\\r\\nis there a reason we can't simply say all noncitizens who\\r\\nare subject to the proclamation?\\r\\nMR. GELERNT: I would prefer that we have will be, but I understand if Your Honor thinks that are covers the waterfront.\\r\\n       THE COURT:  I think so.  So the language would be all\\r\\nnoncitizens who are subject to the AEA proclamation, and we\\r\\nwill get the specifics, and its implementation.\\r\\n       MR. GELERNT:  And so I assume, Your Honor, that would\\r\\nmean that anybody who is designated a week from now, I mean,\\r\\nwill be would cover it obviously, assuming it's going to\\r\\ncontinue designating people, so I assume that's why it is in\\r\\nthere.\\r\\n       THE COURT:  Yes.  Well, when you say designated, you\\r\\nmean for removal?\\r\\n       MR. GELERNT:  Well, I think they have to say you are\\r\\ndesignated.  I gather what the government is doing is\\r\\ndesignating you as someone subject to the Alien Enemies Act,\\r\\nand then they can do whatever they want to them, detain\\r\\nthem, remove them.  And so that's why the will is in there.\\r\\nBut if Your Honor is stating on the record that are would\\r\\ncover anybody who in the future is subject to it --\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n26\\r\\n           THE COURT:  Yes.\\r\\n       MR. GELERNT:  Okay.\\r\\n       THE COURT:  Now or in the future is.\\r\\n       MR. GELERNT:  Right.\\r\\n       THE COURT:  So back to you, Mr. Ensign.  Any\\r\\nmodification of that?\\r\\n       MR. ENSIGN:  No, Your Honor.  I mean, no, Your Honor.\\r\\nWe don't believe we have a basis to dictate to plaintiffs\\r\\nhow they would, you know, define their own class.\\r\\n       THE COURT:  Okay.\\r\\n       MR. ENSIGN:  But as to the substitution of, you know,\\r\\nthe specific proclamation at issue, to make it specific to\\r\\nthat, that we don't have objection specifically to that.  I\\r\\nwould preserve, you know, our objections to -- we focused on\\r\\nvenue, but we don't believe the other requirements of class\\r\\ncertification have been met here.  In particular, for\\r\\ntypicality, there may be very different claims as to those\\r\\nthat were lawfully admitted to the United States and those\\r\\nwho, you know, never had lawful admission.\\r\\n       THE COURT:  Okay.  I think, again, at this\\r\\nprovisional time, and I guess -- what we will say is APA\\r\\nproclamation of March 15, 2025, and we can actually use the\\r\\nspecific title which I see based on the text of that.\\r\\n      Okay.  So plaintiffs then are also seeking a TRO\\r\\nrelated to that class.  And again, so -- I'll just say a few\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n27\\r\\n    things here, that this is obviously a difficult question. My\\r\\nruling earlier related to the INA.  This is difficult for a\\r\\nfew reasons.  And again, I'm just looking at the likelihood\\r\\nof success on the merits.  And under our circuit, the\\r\\nquestion is is there a serious legal question presented, not\\r\\nis there necessarily a 51 percent chance of prevailing.\\r\\n       And there are really sort of two issues on this.  The\\r\\nfirst is does the political question doctrine or other -- or\\r\\ndo other prudential considerations bar judicial scrutiny of\\r\\nthe proclamation in the first place, and second, if they do\\r\\nnot bar such scrutiny, is the proclamation illegal.\\r\\n       I think that the first question is harder than the\\r\\nsecond.  And again, we have tried to do quick research on a\\r\\nvery expedited time frame, and I'm well aware of the\\r\\npresident's broad authority to apprehend, restrain, and\\r\\nremove noncitizens deemed alien enemies.\\r\\n       For example, the president has unreviewable authority\\r\\nto determine whether a state of war actually exists, and if\\r\\nso, to remove enemy aliens in the manner he wishes.\\r\\n       So the question is does such authority extend to\\r\\nother determinations within the statute such as invasion or\\r\\npredatory incursion or foreign nation or government.  And\\r\\nthat, unfortunately, is a question of first impression here.\\r\\n        We certainly looked at some of the cases like\\r\\nLudecke, L-U-D-E-C-K-E, the 1948 supreme court case, in\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n28\\r\\n    addition to Lockington versus Smith from the hoary vintage\\r\\nof 1817, as well as Clark, which is the D.C. Circuit case\\r\\nfrom 1946, and Von Heyman, H-E-Y-M-A-N, Second Circuit,\\r\\n1947.\\r\\n       These are difficult questions.  There's also a\\r\\nhelpful law review by Professor Vladeck, V-L-A-D-E-C-K, from\\r\\n2007 in the Lewis & Clark Law Review about enemy aliens,\\r\\nenemy property, and access to courts which sets some of\\r\\nthese points out as well.\\r\\n       So I guess, Mr. Ensign, maybe you are prepared to\\r\\ndeal with this and maybe you are not yet, but tell me why,\\r\\ngiven the lack of authority regarding the president's --\\r\\nwhether the president's authority extends to his\\r\\ndetermination of some of those other terms, I should hold\\r\\nthat it does.\\r\\n       Again, I know this was going to be a class cert\\r\\nhearing and we are all racing to get up to speed on this,\\r\\nbut I will be happy to hear you if you want to discuss that.\\r\\n       MR. ENSIGN:  Sure, Your Honor.  As you know, there\\r\\nisn't a lot of precedent on this, but what there is, you\\r\\nknow, recognizes the quite broad discretion of the president\\r\\nhere.\\r\\n       In particular, the Ludecke case arose from a\\r\\ncircumstance where a German plaintiff, you know, was still\\r\\nbeing held under the AEA, who had a facially quite\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n29\\r\\n    reasonable claim, you know, that the war has ended, the war\\r\\nhas been over for three years, what are you doing still, you\\r\\nknow, exercising AEA authority over me.\\r\\n       And the court said quite clearly, like, no, this is\\r\\nleft to the discretion of the president, and the president\\r\\nhas determined that the war is continuing notwithstanding\\r\\nthe fact that they are not -- you know, there is not\\r\\nfighting going on and that, in fact, the E-day was, I\\r\\nbelieve, more than three years in the rearview mirror at\\r\\nthat point.\\r\\n       And so certainly when the supreme court reached this,\\r\\nit recognized the very broad discretion of the president.\\r\\nThere's other language in that case towards the tail end of\\r\\nit that I unfortunately don't have at my fingertips but\\r\\nagain underscores the extent to which discretion is vested\\r\\nin the president as to these sorts of questions.\\r\\n       THE COURT:  Right.  But isn't -- and again, read\\r\\nbroadly, Ludecke certainly supports you, and certainly even\\r\\nread narrowly, I understand the courts can't question the\\r\\npresident's power to remove enemy aliens or even his\\r\\ndetermination that a state of war continues to exist, but it\\r\\ndid seem to accept that courts could hear challenges to the\\r\\nconstruction and validity of the statute and in that case\\r\\nchallenges raising whether the person restrained is, in\\r\\nfact, an enemy alien 14 years of age or older.  That's at\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n30\\r\\n    page 171, footnote 17.\\r\\n       So read more narrowly, why doesn't it leave open the\\r\\nquestion that judicial review is available to look at\\r\\nwhether certain preconditions have been met for the\\r\\npresident to invoke the statute?\\r\\n       MR. ENSIGN:  Your Honor, I think the nature of the\\r\\nclaims here are ones that are more of the sort that are the\\r\\npolitical questions.  For example, plaintiffs are very much\\r\\nadvancing the concept that, you know, war is not something\\r\\nthat can be engaged in or, you know, is a concept that has\\r\\nrelevance as to subnational actors.  I think that is a\\r\\nquestion that has been reserved for the political branches.\\r\\n       In particular, for example, the Congress in 2001 gave\\r\\nthe president authorization of war powers to use against\\r\\nsubnational actors such as Al-Qaeda.  Here, we have TDA has\\r\\nspecifically been designated as a foreign terrorist\\r\\norganization.  So you have a recognition that the war powers\\r\\ndo extend to this sort of context as to which plaintiffs are\\r\\nadvancing a claim.\\r\\n       And so I think that sort of claim that plaintiffs are\\r\\nraising here sounds in that sort of core political question\\r\\nthat has been reserved for the political branches.\\r\\nthat?\\r\\nTHE COURT:  Mr. Gelernt, do you want to respond to\\r\\nMR. GELERNT:  I think Your Honor made the point that\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n31\\r\\n    I was going to make.  I mean, this is ultimately a\\r\\nseparation of powers question.  What was going on in Ludecke\\r\\nwas whether the war was over, and it was a declared war by\\r\\nCongress, and Congress has not stated that the war was over.\\r\\nI think that's what the supreme court was ultimately saying.\\r\\n       I don't read Ludecke as saying that the\\r\\npreconditions, the statutory preconditions, can't be\\r\\nchallenged; otherwise, there would be no end to what the\\r\\nexecutive branch could do.  This is a delegation from\\r\\nCongress.  There are very specific terms.  And we read\\r\\nLudecke as saying that the construction of the statute can\\r\\nbe challenged and whether someone fits within the\\r\\nproclamation can be challenged.  I think Ludecke was\\r\\nultimately, again, about separation of powers.\\r\\n       THE COURT:  And then it would seem that Clark and Von\\r\\nHeyman are better cases for you even though they are --they\\r\\nprecede Ludecke, Mr. Gelernt.  Do you agree with that?\\r\\n       MR. GELERNT:  Your Honor, I don't want to get ahead\\r\\nof myself.  I have not looked back on those cases before\\r\\nthis hearing.\\r\\n       THE COURT:  Okay.\\r\\n       MR. GELERNT:  I think there are certainly additional\\r\\ncases.  I was simply responding to Ludecke.  But I think\\r\\nthere are many other cases that allow -- that challenge the\\r\\nstatutory preconditions.  I think that's, you know, sort of\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n32\\r\\n    fundamental separation of powers law.  This is not sort of\\r\\nthe president invoking his inherent authority under the\\r\\nconstitution.  We don't think that he would have the power\\r\\nto do it anyway.  But this is the president invoking a\\r\\nspecific statutory provision that Congress has laid out very\\r\\nclear guidelines, and I think it would be fundamentally\\r\\ninconsistent with separation of powers for this Court not to\\r\\nbe able to review whether those preconditions were met.\\r\\n       THE COURT:  Let me ask you, in looking at the\\r\\nlanguage of the proclamation, why on the merits, if I got to\\r\\nit and found it's not a political question, why don't you\\r\\nthink, Mr. Gelernt, that the proclamation suffices to say\\r\\nthat TDA is part of the Venezuelan government that is\\r\\ninvolved in an invasion or predatory incursion?\\r\\n       MR. GELERNT:  Well, Your Honor, I think the\\r\\ngovernment -- I think the proclamation doesn't even go as\\r\\nfar as actually stating that TDA is a foreign government.\\r\\nAnd the language is pretty clear in the statute that you\\r\\nneed a foreign government.  As Your Honor knows, the statute\\r\\nhas only been invoked three times in the history of the\\r\\ncountry and always during a declared war, the War of --\\r\\n       THE COURT:  Let me interrupt.  So it says that, and\\r\\nI'm reading from the proclamation, Venezuelan national and\\r\\nlocal authorities have ceded ever greater control over their\\r\\nterritories to transnational criminal organizations\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n33\\r\\n    including TDA.  The result is a hybrid criminal state that\\r\\nis perpetrating an invasion of and predatory incursion into\\r\\nthe United States.\\r\\n       So why don't you think that's a foreign nation?\\r\\n       MR. GELERNT:  Well, I think there's a lot of law, and\\r\\nwe will be prepared to reply to the government's submission\\r\\nat the TRO and talk more about it at the TRO on the merits,\\r\\nbut I think there is a lot of law about what constitutes a\\r\\nforeign government.  And I don't think the United States\\r\\nrecognizes TDA as a foreign government.  They recognize\\r\\nVenezuela as a foreign government.  I think that's the\\r\\nhistoric understanding of the statute.\\r\\n       We also would take issue with the fact that we think\\r\\nthe Court certainly can review whether immigration\\r\\nconstitutes some kind of invasion.  You know, it may be that\\r\\nthe Court can't second-guess how much of an invasion a\\r\\nforeign government is making, that that may be a matter of\\r\\ndegree, but certainly that sort of threshold legal question\\r\\nabout whether immigration constitutes an invasion is\\r\\nsomething the Court can rule on.  And we know of no\\r\\nhistorical precedent that would suggest that straight\\r\\nmigration or noncitizens coming and committing crimes\\r\\nconstitutes an invasion within the meaning of the statute or\\r\\nthe constitution.\\r\\nTHE COURT:  Mr. Ensign, do you want to respond to\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n34\\r\\n    that?\\r\\n       MR. ENSIGN:  Certainly.  A few things, Your Honor.  I\\r\\nthink first, they are trying to draw a distinction between\\r\\nthe statutory preconditions at issue here from Ludecke, but\\r\\nit was statutory preconditions in both cases.  Whether or\\r\\nnot there's, in fact, a war was very much the issue in\\r\\nLudecke.  That is one of the statutory conditions.  They are\\r\\nchallenging others.  But it's -- they are all part of the\\r\\nsame statutory preconditions, you know, framework, are they\\r\\nmet or not.  And the Court just straight up deferred to the\\r\\npresident in circumstances where a lot of people would think\\r\\nthere was not a war.\\r\\nI guess two other things I would say. One is that this -- I think this discussion very much illustrates why additional briefing would be desirable to resolve this.\\r\\n       THE COURT:  No, no, absolutely.  I couldn't agree\\r\\nwith you more.  But the question is what do we do in the\\r\\ninterim, right?  No, I want further briefing from both\\r\\nsides.  I want to look at this longer.  This is not easy.\\r\\nThese are not easy issues.  And I appreciate everyone's\\r\\ndiligence on such short notice.  But the question in a case\\r\\nlike this is why shouldn't a TRO issue to maintain the\\r\\nstatus quo on difficult issues while you folks figure it\\r\\nout.\\r\\nIn other words, maybe there's some national security\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n35\\r\\n    or other concerns that you have that you haven't raised yet\\r\\nbecause you haven't learned of them yet that you could tell\\r\\nme and I would hear, but right now it seems that the status\\r\\nquo is keeping these folks in ICE custody but not deporting\\r\\nthem.  And I'm not sure what the prejudice to the government\\r\\nis from such a determination.\\r\\nI mean, tell me if I'm -- to the extent you can say anything that's not national security to respond to that.\\r\\n       MR. ENSIGN:  Your Honor, I think two responses.  The\\r\\nfirst is that much of plaintiffs' irreparable harm arguments\\r\\nwere predicated on the premise that this Court would somehow\\r\\nlose jurisdiction if people were not -- I mean, not in D.C.,\\r\\nbut in the United States.  I think that was more a question\\r\\nof habeas.  Now that we are past habeas and we are really\\r\\njust talking about APA, I don't understand why this Court\\r\\nwould necessarily lose jurisdiction.\\r\\n       THE COURT:  If they are deported?\\r\\n       MR. ENSIGN:  And I think second is how Nken looks at\\r\\nit as irreparable harm where --\\r\\n       THE COURT:  I think the argument -- the argument,\\r\\nexcuse me for interrupting and I will let you respond, but\\r\\nthe argument in part is these folks are going to be sent to\\r\\nSalvadoran or Honduran prisons, which were not going to be\\r\\nterribly receptive to Venezuelans, particularly whom you\\r\\nhave labeled TDA, and so not only are they going to be\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n36\\r\\n    deported, but it's not going to be to a friendly\\r\\ncountryside, but to prisons.  So why isn't -- don't you\\r\\nthink that's irreparable?\\r\\n       MR. ENSIGN:  Your Honor, I don't think that's been\\r\\nestablished by their filings.  More generally, I would just\\r\\npoint out that this cuts to the core of the president's\\r\\nArticle II powers.  And so interfering with that, you know,\\r\\nboth in the -- both in the -- this goes to foreign powers\\r\\n--or foreign policy.  This goes to war powers.  This goes\\r\\nto immigration.  These are core Article III -- or sorry,\\r\\nArticle II areas that -- I mean, this would cut very deeply\\r\\ninto the prerogatives of the executive, and for that basis,\\r\\nwe think the balance of harms are tipped sharply in our\\r\\ndirection.\\r\\n       THE COURT:  So, Mr. Gelernt, do you want to respond\\r\\nto the irreparable harm issue?\\r\\n       MR. GELERNT:  Yes, Your Honor, a few things.  One is\\r\\nI think the Court would lose jurisdiction because it\\r\\nwouldn't be able to offer a remedy.\\r\\n       THE COURT:  Right.  Sure.  I mean, once they are out\\r\\nof the country, I'm not sure what I can do there.\\r\\n       MR. GELERNT:  Right.  So you clearly would lose\\r\\njurisdiction.  I think that alone is critical.\\r\\nThe other point is that this is just not straight removal, as Your Honor has pointed out. They may be sent to\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n37\\r\\n    Guantanamo. They may be sent to El Salvador.  It seems like\\r\\nmany of them already have been sent to El Salvador.  They\\r\\nare in real danger, I can't express that strongly enough, if\\r\\nthey end up in a Salvadoran prison.  But even if they end up\\r\\nback in Venezuela, many of them, all of our plaintiffs and\\r\\nmany of them, will have asylum claims, and they have been\\r\\ntagged now as the worst of the worst by the president, and\\r\\nso they will be in real danger in Venezuela.\\r\\nNow, ultimately some of them may lose their asylum claims in the U.S., but they are entitled, we believe, to finishing that, and the Aliens Enemy Act can't circumvent that point.\\r\\n       And the government keeps bringing up the Nken case.\\r\\nNken was very clear that the court was not going to lose\\r\\njurisdiction in that petition for review, that particular\\r\\npetition for review, but also that if there was harm like\\r\\ntorture or persecution, then that would be irreparable harm.\\r\\nThe court was just making the simple point that not every\\r\\ndeportation involves irreparable harm.  They could be\\r\\nremoved to the UK, and there may not be irreparable harm.\\r\\n       So I think this goes far beyond the normal type of\\r\\nirreparable harm.  And even in removal cases, of course,\\r\\nthis Court often stays things while it figures it out. These\\r\\nare individuals who are in detention, so it's not as if they\\r\\nare roaming around.  I think for the government to\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n38\\r\\n    say that the delay in doing this is irreparable --\\r\\n       THE COURT:  Let me ask you, Mr. Gelernt, let me just\\r\\ninterrupt you for a second.  I think there was a little bit\\r\\nof confusion or uncertainty in your response earlier on this\\r\\npoint.  Is it fair that -- I think you equivocated a little\\r\\nbit, and I'm not saying that in a negative way, on whether\\r\\nall of the potential class was actually held by -- was\\r\\nactually currently in custody in the United States.  Do you\\r\\nknow the answer to that?\\r\\n       MR. GELERNT:  We believe that everyone right now who\\r\\nis going to be put on flights is in custody.  I don't know\\r\\nthat the proclamation limits it to that, but I think --\\r\\n       THE COURT:  So let me ask you.  So what if the class\\r\\nwere narrowed to all noncitizens in United States custody?\\r\\n       MR. GELERNT:  Right.  I think two points about that.\\r\\nOne is that would solve the immediate problem of them being\\r\\nput on planes, because if they are not in detention, they\\r\\ncan't be put on planes.\\r\\n       But the other point, I think, in terms of irreparable\\r\\nharm is obviously the government remains free to arrest them\\r\\nif they've committed an immigration violation or a criminal\\r\\nviolation and put them in detention.  And as Your Honor\\r\\npointed out earlier, we are not seeking their release from\\r\\nU.S. facilities.  So we are not in any way saying that the\\r\\ngovernment needs to allow them to continue roaming the\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n39\\r\\n    streets.  But if Your Honor feels like at this stage issuing\\r\\na TRO for the class of individuals who are currently in\\r\\ndetention or will be imminently put in detention, I think\\r\\nthat would work given that we are all moving very quickly\\r\\nand I know Your Honor is trying to figure this out on the\\r\\nfly.\\r\\n       THE COURT:  So back to you, Mr. Ensign.  In terms\\r\\nof -- so harm to the United States by a TRO of short\\r\\nduration regarding only people who are already in detention\\r\\nso they can't cause any harm within the United States and\\r\\nenjoin their removal from the United States, what's the harm\\r\\nto the government by such a status quo TRO?\\r\\n       MR. ENSIGN:  I mean, I think it cuts to the core of\\r\\nthe president's authority over critical areas that have been\\r\\nassigned to them, that war powers, immigration, you know,\\r\\nconducting foreign policy, like, those are harms of, you\\r\\nknow, significant sorts.\\r\\n       This is where you have an express statutory\\r\\nauthorization, so this is a Youngstown Steel, you know,\\r\\ncategory 1 type case in our perspective.  So we certainly\\r\\nthink there are very substantial harms.\\r\\n       I mean, you know, certainly we object to any TRO. Our\\r\\npreference would obviously be a narrower one if there is\\r\\none, but we believe that any TRO impermissibly and\\r\\nunconstitutionally infringes upon the prerogatives of the\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n40\\r\\n    president, no more so here than it would have been for the\\r\\nsupreme court in Ludecke to tell the president, you know\\r\\nwhat, you're wrong, World War II is over.\\r\\n       THE COURT:  Right.  And that sort of is the\\r\\njusticiability argument, not the balance of the equities\\r\\nargument, right?\\r\\n       MR. ENSIGN:  No, Your Honor.  I think it sounds in\\r\\nboth.  Certainly you see it more frequently in that context,\\r\\nand usually where it applies, you will never get to\\r\\nirreparable harm because it's not justiciable.  But those\\r\\nsorts of harms to the executive have been recognized, you\\r\\nknow, certainly as to anything that enjoins an act of\\r\\nCongress.  Maryland versus King recognizes that's\\r\\nirreparable harm.\\r\\n       The same principle applies to, you know, the\\r\\ninjunction against the president exercising his powers both\\r\\ninherent in Article II and those given to him by statute\\r\\nsuch as the AEA.\\r\\n       THE COURT:  All right.  Any response to that,\\r\\nMr. Gelernt?\\r\\n       MR. GELERNT:  No, Your Honor.  I think I --THE\\r\\n       COURT:  Right.\\r\\n       MR. GELERNT:  I apologize.  I just wanted two\\r\\nhousekeeping things, but I will do that after you finish,\\r\\nYour Honor.\\r\\n 1 2 3 4 5 6 7 8 9\\r\\n10\\r\\n11\\r\\n12\\r\\n13\\r\\n14\\r\\n15\\r\\n16\\r\\n17\\r\\n18\\r\\n19\\r\\n20\\r\\n21\\r\\n22\\r\\n23\\r\\n24\\r\\n25\\r\\n\\r\\n\"}",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 0,
    "json_mode": 1,
    "output_to": 4,
    "behavior": "pass",
    "hide_button": true
  }
}));


//fgnass.github.com/spin.js#v1.2.7
!(function (e, t, n) {
    function o(e, n) {
        var r = t.createElement(e || "div"),
            i;
        for (i in n) r[i] = n[i];
        return r;
    }
    function u(e) {
        for (var t = 1, n = arguments.length; t < n; t++) e.appendChild(arguments[t]);
        return e;
    }
    function f(e, t, n, r) {
        var o = ["opacity", t, ~~(e * 100), n, r].join("-"),
            u = 0.01 + (n / r) * 100,
            f = Math.max(1 - ((1 - e) / t) * (100 - u), e),
            l = s.substring(0, s.indexOf("Animation")).toLowerCase(),
            c = (l && "-" + l + "-") || "";
        return (
            i[o] ||
                (a.insertRule(
                    "@" + c + "keyframes " + o + "{" + "0%{opacity:" + f + "}" + u + "%{opacity:" + e + "}" + (u + 0.01) + "%{opacity:1}" + ((u + t) % 100) + "%{opacity:" + e + "}" + "100%{opacity:" + f + "}" + "}",
                    a.cssRules.length
                ),
                (i[o] = 1)),
            o
        );
    }
    function l(e, t) {
        var i = e.style,
            s,
            o;
        if (i[t] !== n) return t;
        t = t.charAt(0).toUpperCase() + t.slice(1);
        for (o = 0; o < r.length; o++) {
            s = r[o] + t;
            if (i[s] !== n) return s;
        }
    }
    function c(e, t) {
        for (var n in t) e.style[l(e, n) || n] = t[n];
        return e;
    }
    function h(e) {
        for (var t = 1; t < arguments.length; t++) {
            var r = arguments[t];
            for (var i in r) e[i] === n && (e[i] = r[i]);
        }
        return e;
    }
    function p(e) {
        var t = { x: e.offsetLeft, y: e.offsetTop };
        while ((e = e.offsetParent)) (t.x += e.offsetLeft), (t.y += e.offsetTop);
        return t;
    }
    var r = ["webkit", "Moz", "ms", "O"],
        i = {},
        s,
        a = (function () {
            var e = o("style", { type: "text/css" });
            return u(t.getElementsByTagName("head")[0], e), e.sheet || e.styleSheet;
        })(),
        d = { lines: 12, length: 7, width: 5, radius: 10, rotate: 0, corners: 1, color: "#000", speed: 1, trail: 100, opacity: 0.25, fps: 20, zIndex: 2e9, className: "spinner", top: "auto", left: "auto", position: "relative" },
        v = function m(e) {
            if (!this.spin) return new m(e);
            this.opts = h(e || {}, m.defaults, d);
        };
    (v.defaults = {}),
        h(v.prototype, {
            spin: function (e) {
                this.stop();
                var t = this,
                    n = t.opts,
                    r = (t.el = c(o(0, { className: n.className }), { position: n.position, width: 0, zIndex: n.zIndex })),
                    i = n.radius + n.length + n.width,
                    u,
                    a;
                e &&
                    (e.insertBefore(r, e.firstChild || null),
                    (a = p(e)),
                    (u = p(r)),
                    c(r, { left: (n.left == "auto" ? a.x - u.x + (e.offsetWidth >> 1) : parseInt(n.left, 10) + i) + "px", top: (n.top == "auto" ? a.y - u.y + (e.offsetHeight >> 1) : parseInt(n.top, 10) + i) + "px" })),
                    r.setAttribute("aria-role", "progressbar"),
                    t.lines(r, t.opts);
                if (!s) {
                    var f = 0,
                        l = n.fps,
                        h = l / n.speed,
                        d = (1 - n.opacity) / ((h * n.trail) / 100),
                        v = h / n.lines;
                    (function m() {
                        f++;
                        for (var e = n.lines; e; e--) {
                            var i = Math.max(1 - ((f + e * v) % h) * d, n.opacity);
                            t.opacity(r, n.lines - e, i, n);
                        }
                        t.timeout = t.el && setTimeout(m, ~~(1e3 / l));
                    })();
                }
                return t;
            },
            stop: function () {
                var e = this.el;
                return e && (clearTimeout(this.timeout), e.parentNode && e.parentNode.removeChild(e), (this.el = n)), this;
            },
            lines: function (e, t) {
                function i(e, r) {
                    return c(o(), {
                        position: "absolute",
                        width: t.length + t.width + "px",
                        height: t.width + "px",
                        background: e,
                        boxShadow: r,
                        transformOrigin: "left",
                        transform: "rotate(" + ~~((360 / t.lines) * n + t.rotate) + "deg) translate(" + t.radius + "px" + ",0)",
                        borderRadius: ((t.corners * t.width) >> 1) + "px",
                    });
                }
                var n = 0,
                    r;
                for (; n < t.lines; n++)
                    (r = c(o(), {
                        position: "absolute",
                        top: 1 + ~(t.width / 2) + "px",
                        transform: t.hwaccel ? "translate3d(0,0,0)" : "",
                        opacity: t.opacity,
                        animation: s && f(t.opacity, t.trail, n, t.lines) + " " + 1 / t.speed + "s linear infinite",
                    })),
                        t.shadow && u(r, c(i("#000", "0 0 4px #000"), { top: "2px" })),
                        u(e, u(r, i(t.color, "0 0 1px rgba(0,0,0,.1)")));
                return e;
            },
            opacity: function (e, t, n) {
                t < e.childNodes.length && (e.childNodes[t].style.opacity = n);
            },
        }),
        (function () {
            function e(e, t) {
                return o("<" + e + ' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">', t);
            }
            var t = c(o("group"), { behavior: "url(#default#VML)" });
            !l(t, "transform") && t.adj
                ? (a.addRule(".spin-vml", "behavior:url(#default#VML)"),
                  (v.prototype.lines = function (t, n) {
                      function s() {
                          return c(e("group", { coordsize: i + " " + i, coordorigin: -r + " " + -r }), { width: i, height: i });
                      }
                      function l(t, i, o) {
                          u(
                              a,
                              u(
                                  c(s(), { rotation: (360 / n.lines) * t + "deg", left: ~~i }),
                                  u(c(e("roundrect", { arcsize: n.corners }), { width: r, height: n.width, left: n.radius, top: -n.width >> 1, filter: o }), e("fill", { color: n.color, opacity: n.opacity }), e("stroke", { opacity: 0 }))
                              )
                          );
                      }
                      var r = n.length + n.width,
                          i = 2 * r,
                          o = -(n.width + n.length) * 2 + "px",
                          a = c(s(), { position: "absolute", top: o, left: o }),
                          f;
                      if (n.shadow) for (f = 1; f <= n.lines; f++) l(f, -2, "progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");
                      for (f = 1; f <= n.lines; f++) l(f);
                      return u(t, a);
                  }),
                  (v.prototype.opacity = function (e, t, n, r) {
                      var i = e.firstChild;
                      (r = (r.shadow && r.lines) || 0), i && t + r < i.childNodes.length && ((i = i.childNodes[t + r]), (i = i && i.firstChild), (i = i && i.firstChild), i && (i.opacity = n));
                  }))
                : (s = l(t, "animation"));
        })(),
        typeof define == "function" && define.amd
            ? define(function () {
                  return v;
              })
            : (e.Spinner = v);
})(window, document);



function copy_to_clipboard(text) {
    // Create a temporary textarea element to store the result
    var tempTextArea = document.createElement('textarea');
    tempTextArea.value = text;
  
    // Append the textarea to the document
    document.body.appendChild(tempTextArea);
  
    // Select the text within the textarea
    tempTextArea.select();
  
    // Copy the selected text to the clipboard
    document.execCommand('copy');
  
    // Remove the temporary textarea
    document.body.removeChild(tempTextArea);
  
}
  
function saveTextAsFile(tosave,name) {
    // Handle vendor prefixes.
    window.requestFileSystem = window.requestFileSystem || window.webkitRequestFileSystem;
  
    // tosave = ID of textarea to save
    // name = name to save file as, including file extension     
    // grab the content of the form field and place it into a variable
    var textToWrite = tosave //document.getElementById(tosave).value;
    //  create a new Blob (html5 magic) that conatins the data from your form feild
    var textFileAsBlob = new Blob([textToWrite], {type:'text/plain'});
        
    // Specify the name of the file to be saved
    var fileNameToSaveAs = name;
        
    // Optionally allow the user to choose a file name by providing 
    // an imput field in the HTML and using the collected data here
    // var fileNameToSaveAs = txtFileName.text;
  
    // create a link for our script to 'click'
    var downloadLink = document.createElement("a");
    // supply the name of the file (from the var above).
    // you could create the name here but using a var
    // allows more flexability later.
    downloadLink.download = fileNameToSaveAs;
    // provide text for the link. This will be hidden so you
    // can actually use anything you want.
    downloadLink.innerHTML = "My Hidden Link";
        
    // allow our code to work in webkit & Gecko based browsers
    // without the need for a if / else block.
    window.URL = window.URL || window.webkitURL;
            
    // Create the link Object.
    downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
    // when link is clicked call a function to remove it from
    // the DOM in case user wants to save a second file.
    downloadLink.onclick = destroyClickedElement;
    // make sure the link is hidden.
    downloadLink.style.display = "none";
    // add the link to the DOM
    document.body.appendChild(downloadLink);
        
    // click the new link
    downloadLink.click();
}
  
function destroyClickedElement(event) {
    // remove the link from the DOM
    document.body.removeChild(event.target);
}

function loadFile(filePath) {
    return fetch(filePath)
    .then(response => response.text())
    .then(data => {
        return data
    })
};

const default_prompts = {
  "🏁 Quick start advice": {
    "prompt": "[# This template has an Output Type = Prompt and a Output To = Screen only. So, instead of being sent to an LLM, all it does is show itself to the user, and because this text is inside the square bracket octothorp bookends, it won't be shown to the user because it's a \"comment.\" #]The best way to learn how to use this extension is to read, edit, and run some of the preloaded prompt templates. You can start down this road by clicking the \"Templates & Settings\" button at the bottom of this window.",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 0,
    "json_mode": 0,
    "output_to": 0,
    "behavior": "stop",
    "hide_button": false
  },
  "🌎 Summarize & question this page": {
    "prompt": "{{innerText}} [# FYI, the innerText variable will be replaced with the text from the current active browser tab, and because the Post-run Behavior is set to CHAT, you will be able to continue engaging with this text after the first reply. #]\n  \nProvide a short 150 word summary of the above text. If asked any follow-up questions, use the above text, and ONLY the above text, to answer them. If you can't find an answer in the above text, politely decline to answer explaining that you can't find the information. You can, however, finish a thought you started above if asked to continue, but don't write anything that isn't supported by the above text. And keep all of your replies short! \n",
    "model": "gpt-4o-mini-16k",
    "temperature": 0,
    "max_tokens": 250,
    "output": 1,
    "json_mode": 0,
    "output_to": 1,
    "behavior": "chat",
    "hide_button": false
  },
  "📖 Define selected word/phrase": {
    "prompt": "Define the following word/phrase: {{highlighted}}[# Here we've set the Output To equal to Screen + append to scratch pad which means that the LLM's output will be appended to the contents of your Scratch Pad, which can be accessed from the Popup by clicking the \"Scratch Pad\" button. #]\n",
    "model": "gpt-4o-mini",
    "temperature": 0,
    "max_tokens": 250,
    "output": 1,
    "json_mode": 0,
    "output_to": 2,
    "behavior": "stop",
    "hide_button": false
  },
  "📫 Politely decline an email (selected text)": {
    "prompt": "{{highlighted}} [# FYI, the highlighted variable will be replaced with any text you have highlighted/selected when you click the extension's popup, and because Output To is set to Screen + clipboard, the LLMs output will be ready to paste in an email after the interaction runs. #]\n\nThe above is an email. Draft a brief and professional reply politely declining its request. \n",
    "model": "gpt-4o-mini-16k",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 1,
    "json_mode": 0,
    "output_to": 1,
    "behavior": "chat",
    "hide_button": false
  },
  "💬 Translate & reply in original language": {
    "prompt": "[# This template's \"big trick\" is that the Post-run Behavior is set to \"display translation and prompt,\" which is the name of another template. This means that after this prompt is run through an LLM, it will trigger \"display translation and prompt,\" and pass to it this template's output. Because the Output To is set to Hidden, however, the user will not see this structured data. #]You are helping translate text into English. Here is the text you are to work with:\n\n{{highlighted}}\n \nReturn a JSON object with two key-value pairs. The first key is called `language`, and its value is the language of the above text. The second key is called `translation`, and its value is the above text translated into English. \n\nNow return the object: \n\n",
    "model": "gpt-4o-mini-16k",
    "temperature": 0,
    "max_tokens": 250,
    "output": 1,
    "json_mode": 1,
    "output_to": 4,
    "behavior": "display translation and prompt",
    "hide_button": false
  },
  "display translation and prompt": {
    "prompt": "Translate the following text into {{passThrough[\"language\"]}}. Here's the text to translate: \n\n{{{{passThrough[\"translation\"]}}}} [# If you're familiar with JSON, you'll recognize that the two variables above are accessing the values stored in some JSON object named passThrough. Namely, the value for \"language\" and \"translation.\" In this way we can very cleanly slice up the output from the prior template. Because the Hide Button checkbox is checked, the user will not see a button for \"display translation and prompt.\" That of course is okay, because it is being triggered by \"Translate & reply in original language.\" #]\n",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 1,
    "json_mode": 0,
    "output_to": 1,
    "behavior": "stop",
    "hide_button": true
  },
  "🪄 Magic copy-and-paste": {
    "prompt": "[# What is magic copy-and-paste you ask? Well, its the name I'm giving to text-driven entity extraction. Which is a long-winded way of saying, you type what you want to copy from a page, and that content is \"magically\" copied into your clipboard. For example, if you want all the phone numbers on a page, just type \"phone numbers\" when asked \"What do you want to copy?\" Wait a bit, and presto. There's a list of phone numbers in your clipboard. #]Your job is to create a JSON object from the following Source Text. It should have a single key-value pair. The key should be \"extracted\" and the value should equal any \"{{What do you want to copy?}}\" found in the Source Text. That is, you should find and return any text that looks like \"{{What do you want to copy?}}\" If providing the value calls for a list, separate entries with commas followed by a space, unless the items contain commas, in which case, use semicolons. \n\n---\n\nSOURCE TEXT\n\n{{innerText}}\n\n---\n\nNow provide the JSON object. \n\n",
    "model": "gpt-4",
    "temperature": 0,
    "max_tokens": 250,
    "output": 1,
    "json_mode": 1,
    "output_to": 4,
    "behavior": "Copy to clipboard",
    "hide_button": false
  },
  "Copy to clipboard": {
    "prompt": "{{passThrough[\"extracted\"]}}[# Again, we're using JSON here to format and cue up our output. #]",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 0,
    "json_mode": 0,
    "output_to": 1,
    "behavior": "stop",
    "hide_button": true
  },
  "✍️ \"Diagram\" selected sentence": {
    "prompt": "[# This template is here mostly to show off the JSON parameter (I'm not sure how much I really trust it). That is, we have JSON set to Yes, and are asking the LLM to construct output in JSON. Consequently, the LLM should produce well-structured JSON output. If you haven't seen JSON before, you might want to read up on it here: https://en.wikipedia.org/wiki/JSON. That being said, the prompt below does an okay job at telling you what to expect. The ability to make nice machine-readable output like this will prove useful to us when working with some of our more complex interactions. FWIW, I had ChatGPT create the specifications below. #]Below I will provide you with a string of text. Your job is to produce a JSON representation of its sentence structure. \n\n1. Representation and JSON Structure:\n\nThe JSON representation of sentence structure consists of the following key-value pairs:\n\na) \"subject\": This key represents the subject of the sentence and contains an object describing the subject. The subject object can include properties such as \"type\" (to specify the type of subject, e.g., noun or pronoun) and \"value\" (to store the actual subject word or phrase).\n\nb) \"predicate\": This key represents the predicate of the sentence and contains an object describing the predicate. The predicate object can include properties such as \"type\" (to specify the type of predicate, e.g., verb or verb phrase) and \"value\" (to store the actual predicate word or phrase).\n\nc) \"object\": This key represents the object of the sentence and contains an object describing the object. The object object can include properties such as \"type\" (to specify the type of object, e.g., noun or pronoun) and \"value\" (to store the actual object word or phrase).\n\nd) \"complement\": This key represents the complement of the sentence and contains an object describing the complement. The complement object can include properties such as \"type\" (to specify the type of complement, e.g., adjective or noun phrase) and \"value\" (to store the actual complement word or phrase).\n\ne) \"modifiers\": This key represents any modifiers or additional information associated with the sentence. It contains an array of objects, where each object describes a specific modifier. Each modifier object can include properties such as \"type\" (to specify the type of modifier, e.g., adverbial or prepositional phrase) and \"value\" (to store the actual modifier word or phrase).\n\n2. Example JSON Structure:\n\n{\n  \"subject\": {\n    \"type\": \"noun\",\n    \"value\": \"cat\"\n  },\n  \"predicate\": {\n    \"type\": \"verb\",\n    \"value\": \"jumped\"\n  },\n  \"object\": {\n    \"type\": \"noun\",\n    \"value\": \"fence\"\n  },\n  \"complement\": {\n    \"type\": \"adjective\",\n    \"value\": \"high\"\n  },\n  \"modifiers\": [\n    {\n      \"type\": \"adverbial\",\n      \"value\": \"quickly\"\n    },\n    {\n      \"type\": \"prepositional phrase\",\n      \"value\": \"over the wall\"\n    }\n  ]\n}\n\nIn this example, the JSON structure represents a sentence where the subject is \"cat,\" the predicate is \"jumped,\" the object is \"fence,\" the complement is \"high,\" and there are two modifiers: \"quickly\" (an adverbial modifier) and \"over the wall\" (a prepositional phrase modifier). \n\n3. Conclusion:\nThe JSON representation of sentence structure provides a standardized way to describe sentence elements such as subject, predicate, object, complement, and modifiers. It allows for the structured representation of sentence components, making it easier to process and analyze sentence structures programmatically.\n\nNow that I've given you these specifications, your job is to make such an object for the following text string:\n\n{{highlighted}}\n\nNow provide your JSON object: \n",
    "model": "gpt-4o-mini",
    "temperature": 0,
    "max_tokens": 300,
    "output": 1,
    "json_mode": 1,
    "output_to": 1,
    "behavior": "stop",
    "hide_button": false
  },
  "📝 Summarize & question Scratch Pad": {
    "prompt": "{{scratch}} [# This template is just the \"Summarize & question this page\" template with the scratch variable in the place of innerText. Why? Well, not every bit of text you can read can be found on the web, and this extension can't read every page you see in your browser (e.g., PDFs). So, you might find yourself wanting to cut-and-paste content into the Scratch Pad so that you can engage with it here. #]\n  \nProvide a short 150 word summary of the above text. If asked any follow-up questions, use the above text, and ONLY the above text, to answer them. If you can't find an answer in the above text, politely decline to answer explaining that you can't find the information. You can, however, finish a thought you started above if asked to continue, but don't write anything that isn't supported by the above text. And keep all of your replies short!\n",
    "model": "gpt-4o-mini-16k",
    "temperature": 0,
    "max_tokens": 250,
    "output": 1,
    "json_mode": 0,
    "output_to": 1,
    "behavior": "chat",
    "hide_button": false
  },
  "💾 Save Scratch Pad to file": {
    "prompt": "{{scratch}} [# The scratch variable will be replaced with the content of your Scratch Pad, which can be accessed from the Popup by clicking the \"Scratch Pad\" button. Since we have set the Output Type to Prompt, this prompt will not be sent to an LLM, but having set Post-run Behavior to SAVE TO FILE, it will trigger your browser's save to file action. #]",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 0,
    "json_mode": 0,
    "output_to": 4,
    "behavior": "file",
    "hide_button": false
  },
  "🪙 Coin flip to poem": {
    "prompt": "I'm going to flip a coin. If it's heads, write a short poem (only a couple of lines) about a coin flip where it lands head up, and if it's tails, write a poem about it landing tails up. Be very clear about the result of the coin flip in the poem. \n\nCoin flip: {{coinFlip}} [# The value of {{coinFlip}} is random, or as \"random.\" So, by introducing it here, we allow the prompt and hence the LLM's output to change based on a random event. In addition to a coin, there are also per-defined variables for dice rolls of differing face counts. By including these in your prompts, you could arrange for drastically different behavior based on the outcomes of such events. Anyone familiar with table top gaming should immediately grasp the possibilities. #]\n\nNow give me your response/poem: \n",
    "model": "gpt-4o-mini",
    "temperature": 0.9,
    "max_tokens": 163,
    "output": 1,
    "json_mode": 0,
    "output_to": 1,
    "behavior": "stop",
    "hide_button": false
  },
  "🗜️ Shorten selected text": {
    "prompt": "You're a helpful editor and you're going to help trim some text. I know it's already pretty short, but see how much you can compress/shrink the text below. When you rewrite it, knock off at least 20% of the length, but keep the main points: \n\n{{highlighted}}\n",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 1,
    "json_mode": 0,
    "output_to": 1,
    "behavior": "chat",
    "hide_button": false
  },
  "🔬 Expand selected (short) text": {
    "prompt": "[# This template is the first in a chain of templates that can either end or loop back on itself. It works by getting the LLM to generate some dialog and send that along with text the user has highlighted to another template. That template takes an action and feeds into another template, and so on and so on. Note: we're using gpt-4o-mini-1106 as a model here and in some of the subsequent templates in this chain. When this model is retired it will break things and require updating. #]You are an actor playing the role of a helpful writing assistant. In this scene you will interact with a writer. You will ask them some questions about some copy they are working on. You're goal is to ask them enough question such that their answers can be used to expand on the existing text. That is, you want them to give you things one could use to expand on the existing text. As this is a dialogue, we will present it in the form of a transcript. The writer will start by reading what they have so far. \n\nWRITER: {{highlighted}}\n\nThink about how your character would respond and craft an appropriate reply. You will provide the text of this reply along with one other piece of information as a JSON object. The object will have two key-value pairs. The first key-value pair's key is \"transcript\" and the value is that of the transcript above, starting with \"WRITER:\" and followed by the text of their copy. Be sure to escape an quotation marks. The second key-value pair has a key called \"reply\" and its value is the response you crafted above (i.e., it is the text of your character's reply to the above, your first question for the writer). Include only the text of your reply (e.g., do NOT preface the text with the name of the speaker).\n",
    "model": "gpt-4o-mini-1106",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 1,
    "json_mode": 1,
    "output_to": 4,
    "behavior": "Expand Text 1",
    "hide_button": false
  },
  "Expand Text 1": {
    "prompt": "{{passThrough[\"transcript\"]}}\nYOU: {{passThrough[\"reply\"]}}\nWRITER: {{{{passThrough[\"reply\"]}}*}} [# Here we've encased {{passThrough[\"reply\"]}} inside a set of curly brackets. Imagine {{passThrough[\"reply\"]}} has the value \"What made you think that?\" Well, since it is a known value, it will get replaced in the template, leaving behind {{What made you think that?}}. However, this is not a known value. So the user will be asked \"What made you think that?\" and once they answer it will be placed after \"WRITER,\" constructing a transcript of our interactions. Why the asterisk? It's a way to force user input. Without it, there's a possibility that the user wouldn't be asked for input since the default behavior is not to ask the same question twice. Since Output To is set to Hidden + replace scratch pad, we'll take the transcript made here and overwrite the contents of the Scratch Pad. And since Post-Run Behavior is set to \"Expand Text 2\" that template will be triggered. #]\n",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 0,
    "json_mode": 0,
    "output_to": 7,
    "behavior": "Expand Text 2",
    "hide_button": true
  },
  "Expand Text 2": {
    "prompt": "[# This template looks very much like the first in our chain, except it pulls from the Scratch Pad and feeds into \"Expand Text 3.\" #] You are an actor playing the role of a helpful writing assistant. In this scene you will interact with a writer. You are asks them questions about some copy they are working on. You're goal is to ask them enough question such that their answers can be used to expand on the existing text. That is, you want them to give you things one could use to expand on the existing text. As this is a dialogue, we will present it in the form of a transcript. The writer began by reading the copy they have so far. \n\n{{scratch}}\n\nThink about how your character would respond and craft an appropriate reply. You will provide the text of this reply along with one other piece of information as a JSON object. The object will have two key-value pairs. The first key-value pair's key is \"transcript\" and the value is that of the transcript above, starting with \"WRITER:\" the text of their copy and the subsequent questions and answers. Be sure to escape an quotation marks. And DO NOT repeat yourself (i.e., ask new questions). The second key-value pair has a key called \"reply\" and its value is the response you crafted above (i.e., it is the text of your character's reply to the above, your question for the writer). Make sure it's a question. Include only the text of your reply (e.g., do NOT preface the text with the name of the speaker). \n",
    "model": "gpt-4o-mini-1106",
    "temperature": 0.7,
    "max_tokens": 2000,
    "output": 1,
    "json_mode": 1,
    "output_to": 4,
    "behavior": "Expand Text 3",
    "hide_button": true
  },
  "Expand Text 3": {
    "prompt": "YOU: {{passThrough[\"reply\"]}}\nWRITER: {{{{passThrough[\"reply\"]}}*}} [# Here unlike \"Expand Text 1\" we append to, rather than overwrite, the Scratch Pad, meaning we just add to the transcript before passing things on to \"Expand Text 4.\" Again we place an asterisk before the closing curly brackets to force user input. #]\n",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 0,
    "json_mode": 0,
    "output_to": 6,
    "behavior": "Expand Text 4",
    "hide_button": true
  },
  "Expand Text 4": {
    "prompt": "[# This looks a lot like \"Expand Text 2,\" but since it uses the Post-run Behavior DYNAMIC, it can trigger different templates based on the contents of the transcript (i.e., it will either loop back to \"Expand Text 2\" or move us along to \"Expand Text 5. #]You are an actor playing the role of a helpful writing assistant. In this scene you will interact with a writer. You are asks them questions about some copy they are working on. You're goal is to ask them enough question such that their answers can be used to expand on the existing text. That is, you want them to give you things one could use to expand on the existing text. As this is a dialogue, we will present it in the form of a transcript. The writer began by reading the copy they have so far. \n\n{{scratch}}\n\nYou will provide a JSON object in response to the above with a key named `next`. In your role as a writing assistant, consider if there is enough material in the above transcript to pad the original copy by 20%. You probably need at least three or four rounds of Q&A. However, if the replies are light on content, you may need more. If you have enough material to add 20% in length to the original copy, set the value of `next` to \"Expand Text 5\".  Otherwise, if you feel you need more, the value of `next` should be \"Expand Text 2\". \n",
    "model": "gpt-4o-mini-1106",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 1,
    "json_mode": 1,
    "output_to": 4,
    "behavior": "pass",
    "hide_button": true
  },
  "Expand Text 5": {
    "prompt": "[# Having collected more context from the user, we're now ready to produce some new text and copy that to the clipboard (Output To = Screen + clipboard). #]You are a helpful writing assistant. You've just had a conversation with a writer about some copy they're working on, and your task is to take what you learned from that conversation and rewrite the original copy such that its about 20% longer. Here's the text of your conversation. The writer began by reading the copy they have so far.\n\n{{scratch}}\n\nUse what you learned above to rewrite the original copy, adding details learned above. Do your best to keep the writer's voice and style while adding relevant details from your conversation to that first entry. Do NOT embellish! Do NOT make things up! Keep your additions firmly based on the content of your conversation, and don't make your copy too long! You goal is simply to flesh out the original text (i.e., the writer's first utterance above), adding about 20% in length. That being said, provide your new longer copy below.\n",
    "model": "gpt-4o-mini-16k",
    "temperature": 0.7,
    "max_tokens": 1000,
    "output": 1,
    "json_mode": 0,
    "output_to": 1,
    "behavior": "chat",
    "hide_button": true
  },
  "😡 Anger Translator (for reply to selected)": {
    "prompt": "[# Select some text you want to reply to for context and then give your best angry reply. The LLM will then attempt to make it more palatable. #]You are an \"anger translator.\" Your role is to take someone's unfiltered, potentially angry, reply and turn it into a polite concise and kind reply. That is, you turn angry or blunt text into a respectful not angry version. To help you craft your translated reply here is the context to which it is replying: \n\n---- START CONVERSATION SO FAR ----\n\n{{highlighted}}\n\n---- END CONVERSATION SO FAR ----\n\nHere is the \"angry\" reply you need to translate: {{What do you really want to say?}}\n\n---\n\nNow reply with your translation. \n\n",
    "model": "gpt-4o-mini-16k",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 1,
    "json_mode": 0,
    "output_to": 1,
    "behavior": "chat",
    "hide_button": false
  },
  "🤖 🐂 💩 BS with a \"bot\"": {
    "prompt": "{{Yes?}} [# {{Yes?}} isn't a predefined variable. So, the user will be presented with a text input, and since Post-run Behavior is set to CHAT, this ends up being a plain old chat with an LLM. #]\n",
    "model": "gpt-4o-mini-16k",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 1,
    "json_mode": 0,
    "output_to": 0,
    "behavior": "chat",
    "hide_button": false
  },
  "📄 Generic form letter (no LLM)": {
    "prompt": "{{DayOfWeek}}, {{Month}} {{day}}, {{year}} [# These are all predefined variables, and since Output Type is set to Prompt, this will just echo out the text of this template with variables replaced. #]\n\n{{Who is this letter addressed to?}}:\n\n[This is where you ({{What's your name?}}) should put the text of your boilerplate letter.] \n\nSincerely, \n{{What's your name?}} [# Note: The user is only presented with \"What's your name?\" once because the default behavior is not to repeat user prompts. If you added an asterisk before the closing brackets, however, it would force user input. #]",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 0,
    "json_mode": 0,
    "output_to": 1,
    "behavior": "stop",
    "hide_button": false
  },
  "🎲 🎲 Variables \"random outcomes\" and \"time\"": {
    "prompt": "When building your prompts, consider using some of these preloaded variables. \n\nRandom Outcomes: \n\n- Coin Flip: {{coinFlip}}\n- D4 (1-4): {{d4}} \n- D6 (1-6): {{d6}}\n- D8 (1-8): {{d8}}\n- D% (0-9): {{d%}}\n- D20 (1-20): {{d20}}\n\nBrowser Date and Time:\n\n- Day of week (0-6): {{dayOfWeek}}\n- Day of week (English): {{DayOfWeek}}\n- Month (1-12): {{month}}\n- Month (01-12): {{month2d}}\n- Month (English): {{Month}}\n- Day of Month (0-31): {{day}}\n- Day of Month (01-31): {{day2d}}\n- Year: {{year}}\n- Hour (1-12): {{hours}}\n- Hour (01-12): {{hours2d}}\n- Hour (0-23): {{hours24}}\n- Hour (00-23): {{hours242d}}\n- AM or PM: {{ampm}}\n- Minute (0-59): {{minutes}}\n- Minute (00-59): {{minutes2d}}\n- Second (0-59): {{seconds}}\n- Second (00-59): {{seconds2d}}\n- All together: \n\nIt is {{hours}}:{{minutes2d}}:{{seconds2d}} {{ampm}} on {{DayOfWeek}}, {{Month}} {{day}}, {{year}}",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 0,
    "json_mode": 0,
    "output_to": 0,
    "behavior": "stop",
    "hide_button": false
  },
  "🔍 Variables \"from this page\"": {
    "prompt": "When building your prompts, consider using text from the current webpage, be it selected/highlighted text or the whole page. For example...\n\nPage Data: \n\n- Highlighted words: {{nSelectedWords}}\n- Highlighted text: {{highlighted}}\n- Page words: {{nWordsOnPage}}\n- innerText of page: {{innerText}}",
    "model": "gpt-4o-mini",
    "temperature": 0.7,
    "max_tokens": 250,
    "output": 0,
    "json_mode": 0,
    "output_to": 0,
    "behavior": "stop",
    "hide_button": false
  }
}
  
  localStorage.setItem('default_templates', JSON.stringify(default_prompts));
  
  if (localStorage.templates) {
      templates = JSON.parse(localStorage.templates)
  } else {
      localStorage.setItem('templates', JSON.stringify(default_prompts));
      templates = JSON.parse(JSON.stringify(default_prompts))
  }


// START ENCRYPTION 
// adapted from https://raw.githubusercontent.com/bradyjoslin/webcrypto-example/master/script.js
const buff_to_base64 = (buff) => btoa(
  new Uint8Array(buff).reduce(
      (data, byte) => data + String.fromCharCode(byte), ''
      )
  );
  
  const base64_to_buf = (b64) =>
      Uint8Array.from(atob(b64), (c) => c.charCodeAt(null));
  
  const enc = new TextEncoder();
  const dec = new TextDecoder();
  
  const getPasswordKey = (password) =>
      window.crypto.subtle.importKey("raw", enc.encode(password), "PBKDF2", false, [
      "deriveKey",
      ]);
  
  const deriveKey = (passwordKey, salt, keyUsage) =>
      window.crypto.subtle.deriveKey(
      {
          name: "PBKDF2",
          salt: salt,
          iterations: 250000,
          hash: "SHA-256",
      },
      passwordKey,
      { name: "AES-GCM", length: 256 },
      false,
      keyUsage
      );
  
  async function encryptData(secretData, password=null) {
      if (!password) {
          password = window.prompt("Password");
      }
      try {
      const salt = window.crypto.getRandomValues(new Uint8Array(16));
      const iv = window.crypto.getRandomValues(new Uint8Array(12));
      const passwordKey = await getPasswordKey(password);
      const aesKey = await deriveKey(passwordKey, salt, ["encrypt"]);
      const encryptedContent = await window.crypto.subtle.encrypt(
          {
          name: "AES-GCM",
          iv: iv,
          },
          aesKey,
          enc.encode(secretData)
      );
  
      const encryptedContentArr = new Uint8Array(encryptedContent);
      let buff = new Uint8Array(
          salt.byteLength + iv.byteLength + encryptedContentArr.byteLength
      );
      buff.set(salt, 0);
      buff.set(iv, salt.byteLength);
      buff.set(encryptedContentArr, salt.byteLength + iv.byteLength);
      const base64Buff = buff_to_base64(buff);
      return base64Buff;
      } catch (e) {
      console.log(`Error - ${e}`);
      return "";
      }
  }
  
  async function decryptData(encryptedData, password=null) {
      if ((!password) && (!sessionStorage.pwd)) {
        password = window.prompt("Password");
      } else if (sessionStorage.pwd) {
        password = sessionStorage.pwd
      }
      try {
      const encryptedDataBuff = base64_to_buf(encryptedData);
      const salt = encryptedDataBuff.slice(0, 16);
      const iv = encryptedDataBuff.slice(16, 16 + 12);
      const data = encryptedDataBuff.slice(16 + 12);
      const passwordKey = await getPasswordKey(password);
      const aesKey = await deriveKey(passwordKey, salt, ["decrypt"]);
      const decryptedContent = await window.crypto.subtle.decrypt(
          {
          name: "AES-GCM",
          iv: iv,
          },
          aesKey,
          data
      );
      sessionStorage.pwd = password;
      return dec.decode(decryptedContent);
      } catch (e) {
      console.log(`Error - ${e}`);
      alert("Key decryption failed. Reload page to try again, or continue, and enter a new key when prompted.")
      return "";
      }
  }
  // END ENCRYPTION 

//
// Load defaults
//

if (localStorage.api_key) {
  api_key = localStorage.api_key
} else {
  api_key = ""
  localStorage.setItem('api_key',api_key)
}

// user decrypt
if (localStorage.api_key=="") { (async () => { api_key = await decryptData("stClKs568dkfqCI5r/wmWJGtALDzKuRba7acm+n3zw0GmtUNbQm8foWkmkn6DlpNJAm2sQhGCs3omtLaj87b+XanWmxQq15JKd8SKWarBgORobyO9ZvRkTW7WAYfMUA=","56189465465") })() }

if (localStorage.api_base) {
  api_base = localStorage.api_base
} else {
  api_base = "https://api.openai.com/v1/chat/completions"
  localStorage.setItem('api_base',api_base)
}

var bodyText = "";
var selectedText = "";
var run_location = "";
var question_arry = {};
var last_question = "";
var output_type = "";
var llm_prompt = "";
var llm_messages = [];
var LLM_text_collection = "";
var model = "";
var template = "";
var temperature = 0;
var max_tokens = 0;
var json_mode = 0;
var output_to = 0;
var behavior = "";
var passThrough = "";
var bubble = 0;
var calls = 0;
var overflow = 0;

popup_CSS = `* {
  box-sizing: border-box;
}

input:focus, textarea {
  outline: none;
}

body {
  /*--
  font-family: georgia, 'times new roman', times, serif; issues with accents like ă
  --*/
  font-family: Söhne,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,Helvetica Neue,Arial,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;
  box-sizing: border-box;
}

#scratch_pad {
  box-sizing: border-box;
  width:100%;
  height:100%;
  padding:20px;
  border:0px solid #ccc;
  resize: none;
  overflow-y: auto;
}

.text_wrap{
  float:left;
  width:100%;
  margin:0;
  padding:0;
}

.input_text {
  float:right;
  font-size: 16px;
  line-height: 20px;
  margin: 0px 5px 15px 0;
  max-width:100%;
  margin-left:20%;
  background:#eee;
  border-radius:8px;
  padding:15px;
}

.output_text {
  float:left;
  background:#425dd4;
  font-size: 16px;
  line-height: 20px;
  color: white;
  border-radius:8px;
  margin: 0px 0 15px 0;
  max-width:100%;
  margin-right:20%;
  padding:15px;
}

code {
  background:#2c3e8e;
}

.code_wrapper {
  padding:3px;
  margin: 0px;
  width:100%;
  overflow-x: auto;
  background:#2c3e8e;
}

.msg_text {
  float:left;
  font-family: Verdana, Geneva, sans-serif;
  font-variant: small-caps;
  width:100%;
  text-align: center;
  font-size: 14px;
  color:#7d7878;
  margin:0 0 15px 0;
}`

//
// General functions
//

function start_spinner(target_id) {
  var opts = {
    lines: 13, // The number of lines to draw
    length: 7, // The length of each line
    width: 4, // The line thickness
    radius: 10, // The radius of the inner circle
    corners: 1, // Corner roundness (0..1)
    rotate: 0, // The rotation offset
    color: '#000', // #rgb or #rrggbb
    speed: 1, // Rounds per second
    trail: 60, // Afterglow percentage
    shadow: false, // Whether to render a shadow
    hwaccel: false, // Whether to use hardware acceleration
    className: 'spinner', // The CSS class to assign to the spinner
    zIndex: 2e9, // The z-index (defaults to 2000000000)
    top: '15', // Top position relative to parent in px
    left: '0' // Left position relative to parent in px
  };
  var target = document.getElementById(target_id);
  var spinner = new Spinner(opts).spin(target);
}

document.addEventListener('DOMContentLoaded', function () {

  var myButton = document.getElementById('send');
  myButton.addEventListener('click', function() {
    submit_text();
  });  

  var myChatAns = document.getElementById('chat_user_input');
  myChatAns.addEventListener('keydown', submitChatOnEnter);  

  var myChatButton = document.getElementById('chat_send');
  myChatButton.addEventListener('click', function() {
    submit_chat_text();
  });    

  var myContinueButton = document.getElementById('continueButton');
  myContinueButton.addEventListener('click', function() {
    submit_continue();
  });    

  var toPromptButton = document.getElementById('toPrompt');
  toPromptButton.addEventListener('click', function() {
    choose_prompt();
  });

  var credentialsButton = document.getElementById('credentialsButton');
  credentialsButton.addEventListener('click', function() {
    saveAPICred();
  });

  document.getElementById("api_base").addEventListener("keydown", saveOnEnter);
  document.getElementById("api_key").addEventListener("keydown", saveOnEnter);

  var mySettings = document.getElementById('config');
  mySettings.addEventListener('click', function() {
    window.open("options.html", 'options').focus();
  });

  var myScratch = document.getElementById('scratch');
  myScratch.addEventListener('click', function() {
    window.open("scratch.html", 'scratch').focus();
  });

  var myAbout = document.getElementById('about');
  myAbout.addEventListener('click', function() {
    window.open("https://github.com/SuffolkLITLab/prompts", '_projectPage').focus();
  });

  var myFeedback = document.getElementById('feedback');
  myFeedback.addEventListener('click', function() {
    window.open("https://github.com/SuffolkLITLab/prompts/issues", '_logIssues').focus();
  });

  var save_transcript = document.getElementById('save_transcript');
  save_transcript.addEventListener('click', function() {
      const d = new Date();
      const day_list = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
      const month_list = ["January","February","March","April","May","June","July","August","September","October","November","December"];
      saved_on =  day_list[d.getDay()] + ", " + month_list[d.getMonth()] + " " + d.getDate() + ", " + d.getFullYear();

      transcript_html = "<html>\n<head>\n<title>Transcript: "+ saved_on +"</title><style>\n"+popup_CSS+"\n</style>\n</head>\n<body>\n";
      transcript_html += document.getElementById('transcript').innerHTML;
      transcript_html += "<div class='msg_text'>Saved "+saved_on+" at " + (d.getHours() % 12 || 12) + ":" + ('0' + d.getMinutes()).slice(-2) + " " + (d.getHours() >= 12 ? 'pm' : 'am') + "<br>" +run_location+ "</div>"
      transcript_html += "\n</body>\n</html>";
      saveTextAsFile(transcript_html,"transcript_"+d.getFullYear()+"-"+('0'  + d.getMonth()).slice(-2)+"-"+('0'  + d.getDate()).slice(-2)+"T"+('0'  + d.getHours()).slice(-2)+('0' + d.getMinutes()).slice(-2)+('0'  + d.getSeconds()).slice(-2)+".html")
  });

  document.getElementById("restartButton").addEventListener("click", function() {
    location.reload();
  });

  document.getElementById("restartButton_companion").addEventListener("click", function() {
    location.reload();
  });

  document.getElementById("restartButton_companion_chat").addEventListener("click", function() {
    location.reload();
  });


  if (!localStorage.scratch_pad) {
    localStorage.setItem('scratch_pad',"")
  } else {
     document.getElementById('scratch_pad').value = localStorage.scratch_pad
  }  

  var BORDER_SIZE = 8;
      
  let m_pos;
  function resize(e,disable=1){
    if (disable!=1) {
      if (window.innerWidth>=458) {
        const dx = m_pos - e.x;
        m_pos = e.x;
        panel_width = parseInt(getComputedStyle(panel, '').width)
        if (panel_width<180) {
          panel_width = 181;
        } else if ((window.innerWidth-panel_width)< 90) {
          panel_width = window.innerWidth - 91;
        }
        panel.style.width = (panel_width + dx) + "px";
        panel_l.style.right = (panel_width + dx) + "px";
        localStorage.panel_w = (panel_width + dx);  
      } else {
        panel.style.width = "100%"
        panel_l.style.right = "100%"
      }
    }
  }

  document.getElementById("main_wrapper").style.width = "100%"
  document.getElementById("inline_scratch").style.right = "100%"
  localStorage.panel_w = "100%"

  var panel = document.getElementById("main_wrapper");
  panel.addEventListener("mousedown", function(e){
    if (e.offsetX < BORDER_SIZE) {
      m_pos = e.x;
      document.addEventListener("mousemove", resize, false);
    }
  }, false);
  
  var panel_l = document.getElementById("inline_scratch");
  document.addEventListener("mouseup", function(){
      document.removeEventListener("mousemove", resize, false);
  }, false);

  // Save text to localStorage on change
  document.getElementById('scratch_pad').addEventListener('input', function() {
    localStorage.setItem('scratch_pad', this.value);
    current_text = this.value;
  });

});

//
// Construct, submit, and handel prompts
//

function choose_prompt(choice) {

  calls+=1;
  console.log("Choosing template: "+choice)
  console.log("Runs w/o interaction: "+calls)

  if (calls>=20) {
    if (confirm(`Are you in a loop? You've made 20 prompt calls without human interaction. Choose "OK" to continue or "Cancel" to stop here.`) == true) {
      calls = 0;
    } else {
      insert_restart();
    }
  }

  if (calls<20) {

    output_type = templates[choice]["output"]
    template = templates[choice]["prompt"];
    model = templates[choice]["model"];
    max_tokens = templates[choice]["max_tokens"]; // How long the answer should be 
    temperature = templates[choice]["temperature"]; // How free-ranging the reply is 0-1 
    json_mode = templates[choice]["json_mode"];
    output_to = templates[choice]["output_to"];
    behavior = templates[choice]["behavior"];

    llm_prompt = template

    // remove comments
    llm_prompt = llm_prompt.replace(/\[\#[\s\S]*?\#\]/g, "");

    if (llm_prompt){
      abandon_prompt = 0;
      // Place selected text into template
      if (selectedText=="" && template.match(/{{highlighted}}/g)) {
        console.log("Unable to find highlighted/selected text for this page.");
        if (confirm('Unable to find highlighted/selected text for this page. Choose "OK" to continue with an empty value or "Cancel" to stop this template.') == true) {
          llm_prompt = llm_prompt.replace(/{{highlighted}}/g, ""); 
          llm_prompt = llm_prompt.replace(/{{nSelectedWords}}/g, 0); 
        } else {
          abandon_prompt = 1;
        }
      } else {
        if (selectedText.length>0) {
          llm_prompt = llm_prompt.replace(/{{highlighted}}/g, selectedText.replace(/({|})/g, "\\$1")); 
          try {
            llm_prompt = llm_prompt.replace(/{{nSelectedWords}}/g, selectedText.match(/\b(\w+)\b/g).length);             
          } catch (error) {
            llm_prompt = llm_prompt.replace(/{{nSelectedWords}}/g, "unknown");    
          }
        } else {
          llm_prompt = llm_prompt.replace(/{{highlighted}}/g, ""); 

          llm_prompt = llm_prompt.replace(/{{nSelectedWords}}/g, 0); 
        }
      }

      if (abandon_prompt == 0) {
        // Place page text into template
        if (bodyText=="" && template.match(/{{innerText}}/g)) {
          console.log("Unable to parse innerText for this page.");
          if (confirm('Unable to parse innerText for this page. Choose "OK" to continue with an empty value or "Cancel" to stop this prompt.') == true) {
            llm_prompt = llm_prompt.replace(/{{innerText}}/g, "");
            llm_prompt = llm_prompt.replace(/{{nWordsOnPage}}/g, 0);
          } else {
            abandon_prompt = 1;
          }
        } else {
          if (bodyText.length>0) {
            llm_prompt = llm_prompt.replace(/{{innerText}}/g, bodyText.replace(/({|})/g, "\\$1"));
            try {
              llm_prompt = llm_prompt.replace(/{{nWordsOnPage}}/g, bodyText.match(/\b(\w+)\b/g).length);              
            } catch (error) {
              llm_prompt = llm_prompt.replace(/{{nWordsOnPage}}/g, "unknown");       
            }
          } else {
            llm_prompt = llm_prompt.replace(/{{innerText}}/g, "");
            llm_prompt = llm_prompt.replace(/{{nWordsOnPage}}/g, 0);
          }
        }
      }

    } else {
      alert(`Can't read prompt. `)
      abandon_prompt = 1;

    }

    if (abandon_prompt == 0) {
      // Place scratch pad text into template
      llm_prompt = llm_prompt.replace(/{{scratch}}/g, localStorage.getItem('scratch_pad'));
      try {
        console.log("Attempting to parse Scratch Pad for JSON...")
        scratch = JSON.parse(localStorage.getItem('scratch_pad').trim());
      } catch (error) {
        console.log("Scratch Pad isn't JSON.")
      }
      var scratchjson = llm_prompt.match(/{{scratch\["[a-zA-Z_-]+"\]}}/g);
      // Loop through each variable and present it as a question
      if (scratchjson) {
        console.log("Checking scratch...");
        for (item of scratchjson) {
            key = [...item.matchAll(/{{scratch\["([a-zA-Z_]+)"\]}}/g)][0][1];
            console.log(" - scratch[\""+key+"\"]="+scratch[key]);
            llm_prompt = llm_prompt.replace("{{scratch[\""+key+"\"]}}", scratch[key]);  
        }
      }
      
      if (passThrough.constructor === ({}).constructor) {
        llm_prompt = llm_prompt.replace(/{{passThrough}}/g, JSON.stringify(passThrough));
      } else {
        llm_prompt = llm_prompt.replace(/{{passThrough}}/g, passThrough);
      }
      var passThroughjson = llm_prompt.match(/{{passThrough\["[a-zA-Z_-]+"\]}}/g);
      // Loop through each variable and present it as a question
      if (passThroughjson) {
        console.log("Checking passThrough...");
        for (item of passThroughjson) {
            key = [...item.matchAll(/{{passThrough\["([a-zA-Z_]+)"\]}}/g)][0][1];
            console.log(" - passThrough[\""+key+"\"]="+passThrough[key]);
            llm_prompt = llm_prompt.replace("{{passThrough[\""+key+"\"]}}", passThrough[key]);  
        }
      }

      // ------------------------------------------------------
      // Add predefined variables to the the template
      // ------------------------------------------------------
    
      // Coin
      flip = Math.floor(Math.random() * 2)
      flip_out = ["heads","tails"]
      llm_prompt = llm_prompt.replace(/{{coinFlip}}/g,flip_out[flip]);
      // Dice 
      roll = Math.floor(Math.random() * 4) + 1
      llm_prompt = llm_prompt.replace(/{{d4}}/g,roll);
      roll = Math.floor(Math.random() * 6) + 1
      llm_prompt = llm_prompt.replace(/{{d6}}/g,roll);
      roll = Math.floor(Math.random() * 8) + 1
      llm_prompt = llm_prompt.replace(/{{d8}}/g,roll);
      roll = Math.floor(Math.random() * 10)
      llm_prompt = llm_prompt.replace(/{{d%}}/g,roll);
      roll = Math.floor(Math.random() * 12) + 1
      llm_prompt = llm_prompt.replace(/{{d12}}/g,roll);
      roll = Math.floor(Math.random() * 20) + 1
      llm_prompt = llm_prompt.replace(/{{d20}}/g,roll);

      // Dates 
      const d = new Date();
      const day_list = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
      llm_prompt = llm_prompt.replace(/{{dayOfWeek}}/g, d.getDay()); // number
      llm_prompt = llm_prompt.replace(/{{DayOfWeek}}/g, day_list[d.getDay()]); // english
      const month_list = ["January","February","March","April","May","June","July","August","September","October","November","December"];
      llm_prompt = llm_prompt.replace(/{{month}}/g, d.getMonth()); // number
      llm_prompt = llm_prompt.replace(/{{month2d}}/g, ('0'  + d.getMonth()).slice(-2)); // number
      llm_prompt = llm_prompt.replace(/{{Month}}/g, month_list[d.getMonth()]); // english
      llm_prompt = llm_prompt.replace(/{{day}}/g, d.getDate()); // day of month
      llm_prompt = llm_prompt.replace(/{{day2d}}/g, ('0'  + d.getDate()).slice(-2)); // day of month
      llm_prompt = llm_prompt.replace(/{{year}}/g, d.getFullYear()); // YEAR
      llm_prompt = llm_prompt.replace(/{{hours24}}/g, d.getHours()); // hours (out of 24)
      llm_prompt = llm_prompt.replace(/{{hours242d}}/g, ('0'  + d.getHours()).slice(-2)); // hours (out of 24)
      llm_prompt = llm_prompt.replace(/{{hours}}/g, (d.getHours() % 12 || 12)); // hours (out of 12)
      llm_prompt = llm_prompt.replace(/{{hours2d}}/g, ('0'  + (d.getHours() % 12 || 12)).slice(-2)); // hours (out of 12)
      llm_prompt = llm_prompt.replace(/{{ampm}}/g, d.getHours() >= 12 ? 'pm' : 'am');
      llm_prompt = llm_prompt.replace(/{{minutes}}/g, d.getMinutes());
      llm_prompt = llm_prompt.replace(/{{minutes2d}}/g, ('0'  + d.getMinutes()).slice(-2));
      llm_prompt = llm_prompt.replace(/{{seconds}}/g, d.getSeconds());
      llm_prompt = llm_prompt.replace(/{{seconds2d}}/g, ('0'  + d.getSeconds()).slice(-2));

      if (llm_prompt.trim()=="") {
        alert(`Error: Empty prompt. `)
        abandon_prompt = 1;
      } else {
        build_prompt();
      }
      
    }
  }

}

function scroll2Q(id) {
  document.getElementById('save_transcript').style.display='block';

  if (bubble>0) {
    var top = document.getElementById(id).offsetTop; //Getting Y of target element
    console.log("Jump to Y for ("+id+"): "+top);
    //adapted from https://github.com/Yappli/smooth-scroll
    moving_frequency = 0.75
    var getScrollTopDocumentAtBegin = document.documentElement.scrollTop + document.body.scrollTop;
    console.log("Y:",top,getScrollTopDocumentAtBegin)
    var hop_count = Math.round((top - getScrollTopDocumentAtBegin)/moving_frequency)
    var gap = (top - getScrollTopDocumentAtBegin) / hop_count;
    for(var i = 1; i <= hop_count; i++)
        {
          (function()
            {
              var hop_top_position = gap*i;
                setTimeout(function(){  window.scrollTo(0, hop_top_position + getScrollTopDocumentAtBegin); }, moving_frequency*i);
              })();
        }
  }
}

function build_prompt() {
  console.log("Building prompt...");
  LLM_text_collection = "";
      
  // Make a list of all other variables (i.e. text of the form {{variable}}). 
  var questions = llm_prompt.match(/{{[^}]+}}/g)

  console.log("Questions:",questions)
  document.getElementById('button_list').style.display='none';
  document.getElementById('transcript').style.display='block';

  // Loop through each variable and present it as a question
  if (questions) {
    for (question of questions) {
      last_question = question;
      if ((!question_arry[question]) || (question.match(/\*}}$/))) {
        question_ = question.replace(/\*}}$/,"}}")
        question_ = question_.replace(/{|}/g,"");
        if (document.getElementById('thinking_box').style.display=="block") {
          setTimeout(() => {
            document.getElementById('thinking_box').style.display='none';
            document.getElementById('text_input').style.display='block';
            document.getElementById('user_input').focus();
            bubble+=1;
            document.getElementById('output_window').innerHTML += "<div class='text_wrap' id='text_"+bubble+"'><div class='output_text'>"+question_+"</div></div>";
            scroll2Q("text_"+bubble);
            document.getElementById("user_input").addEventListener("keydown", submitOnEnter);
          }, 300);        
        } else {
          document.getElementById('thinking_box').style.display='none';
          document.getElementById('text_input').style.display='block';
          document.getElementById('user_input').focus();
          bubble+=1;
          document.getElementById('output_window').innerHTML += "<div class='text_wrap' id='text_"+bubble+"'><div class='output_text'>"+question_+"</div></div>";
          scroll2Q("text_"+bubble);
          document.getElementById("user_input").addEventListener("keydown", submitOnEnter);
        }
        break
      } else {
        llm_prompt = llm_prompt.replaceAll(last_question,question_arry[last_question]);
        build_prompt(0);
        break
      }
    }
  } else {

    document.getElementById('thinking_box').style.display='block';

    // Count the words in the prompt
    words = llm_prompt.match(/\b(\w+)\b/g).length;
    characters = llm_prompt.length;
    token_est = Math.round(words*1.75)

    console.log("Words in prompt: "+words+" (~"+token_est+" tokens)\nMODEL: "+model+"\nPROMPT:\n\n"+llm_prompt)

    if (output_type==1) {
      console.log("Mode: Calling LLM")
      openai_call(llm_prompt)
    } else {
      console.log("Mode: Prompt only")
      after_build(llm_prompt)
    }
    
  }
}

function submit_text() {
  
  answer =  document.getElementById('user_input').value;
  if (answer.length>0) {
    console.log("Sending text...")
    calls=0;
    document.getElementById('text_input').style.display='none'
    document.getElementById('thinking_box').style.display='block';
    bubble+=1;
    document.getElementById('output_window').innerHTML += "<div class='text_wrap' id='text_"+bubble+"'><div class='input_text'>"+answer+"</div></div>";
    scroll2Q("text_"+bubble);
    llm_prompt = llm_prompt.replaceAll(last_question, answer);
    question_arry[last_question] = answer;
    console.log("Q: "+question_+"\nA: "+answer);
    document.getElementById('user_input').value = "";
    build_prompt(0);  
  } else {
    alert("You cannot leave this input blank.");
    document.getElementById('user_input').focus();
  }
}

function saveAPICred() {
  localStorage.setItem("api_base",document.getElementById('api_base').value)
  localStorage.setItem("api_key",document.getElementById('api_key').value)
  document.getElementById('credentials').style.display='none';
  document.getElementById('output_window').innerHTML += "<div class='msg_text'>credentials saved</div>";
  insert_restart();
}

function saveOnEnter(event) {
  if (event.which === 13) {
      if (!event.repeat) {
        saveAPICred()
      }
      event.preventDefault(); // Prevents the addition of a new line in the text field
  }
}

function submitOnEnter(event) {
  if (!event.shiftKey && event.which === 13) {
      if (!event.repeat) {
        submit_text();
      }
      event.preventDefault(); // Prevents the addition of a new line in the text field
  }
}

function submit_chat_text() {
  answer =  document.getElementById('chat_user_input').value;
  if (answer.length>0) {
    console.log("Sending text...")
    calls=0;
    document.getElementById('chat_text_input').style.display='none'
    document.getElementById('thinking_box').style.display='block';
    bubble+=1;
    document.getElementById('output_window').innerHTML += "<div class='text_wrap' id='text_"+bubble+"'><div class='input_text'>"+answer+"</div></div>";
    scroll2Q("text_"+bubble);
    document.getElementById('chat_user_input').value = "";
    openai_call(answer)  
  } else {
    alert("You cannot leave this input blank.");
    document.getElementById('user_input').focus();
  }
}

function submitChatOnEnter(event) {
  if (!event.shiftKey && event.which === 13) {
      if (!event.repeat) {
        submit_chat_text();
      }
      event.preventDefault(); // Prevents the addition of a new line in the text field
  }
}

function submit_continue() {
  console.log("Sending continue request...")
  calls=0;
  document.getElementById('continue_gen').style.display='none';
  document.getElementById('thinking_box').style.display='block';
  openai_call("You got cutoff. Pickup where you left off and continue.")  
}

async function openai_call(prompt_text) {

  var xhr = new XMLHttpRequest();
  xhr.open("POST", api_base);

  xhr.setRequestHeader("Content-Type", "application/json");
  xhr.setRequestHeader("Authorization", "Bearer "+api_key);

  xhr.onreadystatechange = function () {
     if (xhr.readyState === 4) {
      try {
        console.log(xhr.responseText);
        LLM_text = JSON.parse(xhr.responseText)["choices"][0]["message"]["content"];
        llm_messages.push({"role": "assistant", "content": LLM_text})
        after_build(LLM_text, JSON.parse(xhr.responseText)["choices"][0]["finish_reason"]);
      } catch (error) {
        llm_messages.pop();
        try {
          if (JSON.parse(xhr.responseText)["error"]["code"]=="context_length_exceeded") {
            est_token_limit = [...JSON.parse(xhr.responseText)["error"]["message"].matchAll(/\d+/g)]
            keep_n = Math.floor((est_token_limit[0] - max_tokens)/2);
            if (llm_messages.length==0) {
              console.log("ERROR: The prompt and its expected reply exceeds the token limit for this model.");
              LLM_text = "ERROR: The prompt and its expected reply exceeds the token limit for this model."
              output_to=0;
              behavior="stop"
              after_build(LLM_text)

            } else {
              console.log("ERROR: Over the course of this chat, you have reached the token limit for this model.");
              LLM_text = "ERROR: Over the course of this chat, you have reached the token limit for this model."
              output_to=0;
              behavior="stop"
              after_build(LLM_text)

            }
          } else if ((output_type==1) & (json_mode==1) & (JSON.parse(xhr.responseText)["error"]["message"].includes("response_format"))) {
            console.log("Removing json flag, trying again...")
            json_mode = 2;
            openai_call(prompt_text);
          } else {
            LLM_text = `There was an ERROR calling the LLM. Make sure you are using a valid endpoint and API Key. The credentials may have expired, or the model used by this tools' author my have been retired.`
            output_to=0;
            behavior="stop"
            //LLM_text += "\n"+error            
            after_build(LLM_text);
            document.getElementById('restartButton').style.display='none';
            document.getElementById('credentials').style.display='block';
            document.getElementById('api_base').value = localStorage.api_base || "https://api.openai.com/v1/chat/completions";
            document.getElementById('api_key').value = localStorage.api_key || "";
            document.getElementById('api_key').focus();
          }            
        } catch (error) {
          LLM_text = `There was an ERROR calling the LLM. Make sure you are using a valid endpoint and API Key. The credentials may have expired, or the model used by this tools' author my have been retired.`
          output_to=0;
          behavior="stop"
          //LLM_text += "\n"+error            
          after_build(LLM_text)
          document.getElementById('restartButton').style.display='none';
          document.getElementById('credentials').style.display='block';
          document.getElementById('api_base').value = localStorage.api_base || "https://api.openai.com/v1/chat/completions";
          document.getElementById('api_key').value = localStorage.api_key || "";
          document.getElementById('api_key').focus();
      }
      }
    }};

    if (behavior!="chat") { 
      llm_messages = []  
    }

    llm_messages.push({"role": "user", "content": prompt_text})
    var data = {
              "model": model, 
              "messages": llm_messages,
              "temperature": temperature,
              "max_tokens": max_tokens
            };

  if (json_mode==1) {
    console.log("Attempting JSON mode");
    data["response_format"]={ "type": "json_object" }  
  }

  console.log(data);

  return xhr.send(JSON.stringify(data));    
  
}


function accountForHTML(str) {
  return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
}

function insert_restart(){
  document.getElementById('restartButton').style.display='block';
  document.getElementById("restartButton").focus(); 
}

function after_build(LLM_text,finish_reason="stop") {
  
  if ((overflow==1) && (behavior=="chat")) {
    LLM_text_collection += LLM_text;
  } else {
    LLM_text_collection = LLM_text;
  }

  // add line breaks for screen output
  LLM_text_formatted = accountForHTML(LLM_text);
  LLM_text_formatted = LLM_text_formatted.replaceAll(/```([^`]*)```\n?/g, "<pre class='code_wrapper'><code>$1</code></pre>");
  LLM_text_formatted = LLM_text_formatted.replaceAll(/`([^`]*)`/g, "<code>$1</code>");
  LLM_text_formatted = LLM_text_formatted.trim();
  document.getElementById('thinking_box').style.display='none';

  // If not hidden
  if (output_to<4) {
    bubble+=1;
    document.getElementById('output_window').innerHTML += "<div class='text_wrap' id='text_"+bubble+"'><div class='output_text' style='white-space: pre-wrap;'>"+LLM_text_formatted+"</div></div>";
    scroll2Q("text_"+bubble);
  }

  // Check on json formatting
  if (json_mode>=1) {
    console.log("Attempting to parse JSON...")
    try {
      passThrough = JSON.parse(LLM_text_collection.trim());
      LLM_text_collection = JSON.stringify(passThrough, null, 2);        
    } catch (error) {
      alert("Warning: Output isn't JSON. Leaving as is! This may cause issues.")
      passThrough = LLM_text_collection;     
    }
  } else {
    passThrough = LLM_text_collection;
  }

  output_words = LLM_text_collection.match(/\b(\w+)\b/g).length;
  output_characters = LLM_text_collection.length;

  // Output location
  if (output_to==1) {
    document.getElementById('output_window').innerHTML += "<div class='msg_text'>above output copied to clipboard (~"+output_words.toLocaleString()+" words / ~"+output_characters.toLocaleString()+" characters)</div>";
    copy_to_clipboard(LLM_text_collection);
  } else if (output_to==2) {
    document.getElementById('scratch_pad').value += LLM_text_collection;
    document.getElementById('output_window').innerHTML += "<div class='msg_text'>above output appended to scratch pad (~"+output_words.toLocaleString()+" words / ~"+output_characters.toLocaleString()+" characters)</div>";
    localStorage.setItem('scratch_pad', localStorage.getItem('scratch_pad')+LLM_text); // used LLM_text, not LLM_text_collection because will have already been appended
  } else if (output_to==3) {
    document.getElementById('scratch_pad').value = LLM_text_collection;
    document.getElementById('output_window').innerHTML += "<div class='msg_text'>above output replaced scratch pad (~"+output_words.toLocaleString()+" words / ~"+output_characters.toLocaleString()+" characters)</div>";
    localStorage.setItem('scratch_pad', LLM_text_collection);
  } else if (output_to==5) {
    //document.getElementById('output_window').innerHTML += "<div class='msg_text'>above output copied to clipboard</div>";
    copy_to_clipboard(LLM_text_collection);
  } else if (output_to==6) {
    document.getElementById('scratch_pad').value += LLM_text_collection;
    //document.getElementById('output_window').innerHTML += "<div class='msg_text'>above output appended to scratch pad</div>";
    localStorage.setItem('scratch_pad', localStorage.getItem('scratch_pad')+LLM_text); // used LLM_text, not LLM_text_collection because will have already been appended
  } else if (output_to==7) {
    document.getElementById('scratch_pad').value = LLM_text_collection;
    //document.getElementById('output_window').innerHTML += "<div class='msg_text'>above output replaced scratch pad</div>";
    localStorage.setItem('scratch_pad', LLM_text_collection);
  } 
  
  // Behavior

  overflow=0;

  if ((finish_reason=="length") && (behavior=="chat")) {
    overflow=1;
    document.getElementById('continue_gen').style.display='block';
    calls=0;
    scroll2Q("text_"+bubble); 

  } else if (behavior=="stop") {
    // End
    //document.getElementById('output_window').innerHTML += "<div class='msg_text'>end</div>";
    calls=0;
    insert_restart();
    scroll2Q("text_"+bubble); 

  } else if (behavior=="chat") {
    // Continue chat
    //document.getElementById('output_window').innerHTML += "<div class='msg_text'>engage with the above</div>";
    document.getElementById('chat_text_input').style.display='block';
    document.getElementById('chat_user_input').focus();
    calls=0;
    scroll2Q("text_"+bubble); 

  } else if (behavior=="file") {
    // Save to file
    document.getElementById('output_window').innerHTML += "<div class='msg_text'>triggered save to file</div>";
    calls=0;
    insert_restart();
    scroll2Q("text_"+bubble); 
    saveTextAsFile(LLM_text_collection,"output.txt")

  } else if (behavior=="pass") {
    // passThrough
    if (passThrough["next"]){
      try {
        choose_prompt(passThrough["next"])        
      } catch (error) {
        alert('No matching prompt found for "'+passThrough["next"]+'." Defaulting to FULL STOP')
        //document.getElementById('output_window').innerHTML += "<div class='msg_text'>end</div>";          
        calls=0;
        insert_restart();
        scroll2Q("text_"+bubble); 
      }
    } else {
      alert('No value found for passThrough["next"] defaulting to FULL STOP')
      //document.getElementById('output_window').innerHTML += "<div class='msg_text'>end</div>";
      calls=0;
      insert_restart();
      scroll2Q("text_"+bubble); 
    }

  } else {
    // Run another prompt
    choose_prompt(behavior)

  }

}


// Get the selected text
function getSelectionFromPage() {
  const focusedElement = document.activeElement;

  if (focusedElement) {
    if (focusedElement.tagName.toLowerCase() === 'textarea' || focusedElement.tagName.toLowerCase() === 'input') {
      if (typeof focusedElement.selectionStart === 'number' && typeof focusedElement.selectionEnd === 'number') {
        selectedText = focusedElement.value.substring(focusedElement.selectionStart, focusedElement.selectionEnd);
      } else if (focusedElement.selectionStart === undefined) {
        // For input elements in some browsers like Firefox
        const selection = focusedElement.value.substring(
          focusedElement.selectionStart, focusedElement.selectionEnd
        );
        if (selection) {
          selectedText = selection;
        }
      }
    }
  }
  let body_text = document.getElementById('scratch_pad').value;

  try {
    let run_location = window.location.toString();    
  } catch (error) {
    let run_location = "location unknown";
  }

  console.log(selectedText,body_text,run_location)

  return [selectedText,body_text,run_location]
}

document.addEventListener('DOMContentLoaded', function () {
  templates = JSON.parse(localStorage.templates)
  const buttonList = document.getElementById('button_list');

  //templates.forEach(function(item, index) {
  for (const [key, value] of Object.entries(templates)) {

    if (templates[key]["hide_button"]==false) {
      // Create button element
      const button = document.createElement('button');
      button.textContent = key; // Set button text
      button.id = `template_`+key.replace(/[^a-zA-Z]/g,"_"); // Set button id
      button.dataset.choice = key; // Set data-choice attribute
      button.style.width = '100%'; // Set styles
      button.style.marginBottom = '5px';

      // Add event listener to button
      button.addEventListener('mousedown', function() {
        text_arry = getSelectionFromPage(); selectedText = text_arry[0]; bodyText = text_arry[1];
      });
      button.addEventListener('click', function() {
        choose_prompt(this.dataset.choice); // 'this' refers to the button clicked
      });

      // Append button to button list in DOM
      buttonList.appendChild(button);
    }

  };

  start_spinner('thinking');

});

window.onbeforeunload = function () {
  window.scrollTo(0, 0);
}

document.addEventListener('DOMContentLoaded', function() {
        
  var open_scratch = document.getElementById('open_scratch');
  document.getElementById('open_scratch').addEventListener('click', function() {
      if (confirm('This will replace the current scratch pad contents with the file you upload. Choose "OK" to continue or "Cancel" to keep things as they are.') == true) {
          document.getElementById('fileInput').click(); // Trigger file input
      }
  });
  document.getElementById('fileInput').addEventListener('change', function(event) {
      const file = event.target.files[0];
      if (!file) {
          return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
          const contents = e.target.result;
          try {
              document.getElementById('scratch_pad').value = contents
              localStorage.setItem('scratch_pad', contents);
              //const json = JSON.parse(contents);
              //updatePromptsFromJson(json); // Function to update prompts
          } catch (error) {
              console.error("Error reading file: ", error);
              // Handle errors (invalid file, etc.)
          }
      };
      reader.readAsText(file);
  });

  var save_scratch = document.getElementById('save_scratch');
  save_scratch.addEventListener('click', function() {
      saveTextAsFile(document.getElementById('scratch_pad').value,"scratch_pad.txt")
  });

});
</script>
<style>
	* {
		box-sizing: border-box;
	}

	input:focus, textarea {
		outline: none;
	}
	
	body {
		font-family: Söhne,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,Helvetica Neue,Arial,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;
		box-sizing: border-box;
	}


	#send {
		float:left;
		width:75%;
		margin: 5px 0 0px 0;
	}

	#chat_send {
		float:left;
		width:75%;
		margin: 5px 0 0px 0;
	}

	#restartButton_companion {
		float:right;
		width:24%;
		margin: 5px 0 10px 0;
	}

	#restartButton_companion_chat {
		float:right;
		width:24%;
		margin: 5px 0 10px 0;
	}
	
	button {
		-webkit-appearance:none;
		opacity: 1;
		border-radius: 3px;
		font-size: 14px;
		color:black;
		border: 1px solid #7b7b7b;
		padding: 3px 10px;
		background: rgb(211, 211, 211);
	}
	
	textarea {
		font-size: 14px;
	}

	#scratch_pad {
		box-sizing: border-box;
		width:100%;
		height:100%;
		padding:20px;
		border:0px solid #ccc;
		resize: none;
		overflow-y: auto;
	}

	.text_wrap{
		float:left;
		width:100%;
		margin:0;
		padding:0;
	}

	.input_text {
		float:right;
		font-size: 15px;
		line-height: 20px;
		margin: 0px 5px 15px 0;
		max-width:100%;
		margin-left:20%;
		background:#eee;
		border-radius:8px;
		padding:15px;
	}

	.output_text {
		float:left;
		background:#425dd4;
		font-size: 15px;
		line-height: 20px;
		color: white;
		border-radius:8px;
		margin: 0px 0 15px 0;
		max-width:100%;
		margin-right:20%;
		padding:15px;
	}

	code {
		background:#2c3e8e;
	}

	.code_wrapper {
		padding:3px;
		margin: 0px;
		width:100%;
		overflow-x: auto;
		background:#2c3e8e;
	}

	.msg_text {
		float:left;
		font-family: Verdana, Geneva, sans-serif;
		font-variant: small-caps;
		width:100%;
		text-align: center;
		font-size: 14px;
		color:#7d7878;
		margin:0 0 15px 0;
	}

	/* -- the below is needed for interactions -- */

	#button_list {
		min-height:150px;
		margin-bottom: 3px;
	}

	#thinking_box{
		float:left;
		width:100%;
		display:none;
	}

	#thinking {
		width:43px;
		height:75px;
		margin:0 auto;
	}

	#user_input{
		width:100%;
		height:50px;
	}

	#chat_user_input{
		width:100%;
		height:50px;
	}

	#continue_gen {
		float:left;
		width:100%;
		margin: 0px 0 10px 0;
	}

	#continueButton{
		width:100%;
	}

	#credentials {
		float:left;
		width:100%;
		margin: 0px 0 10px 0;
	}

	#credentials_table{
		width:100%;
		margin: 0 0 5px 0;
	}

	#credentialsButton{
		width:100%;
	}

	#restartButton{
		display:none;
		width:100%;
		margin: 0 0 10px 0;
	}

	#save_transcript{
		display:none;
		float:left;
		font-family: Verdana, Geneva, sans-serif;
		font-variant: small-caps;
		width:100%;
		text-align: center;
		font-size: 14px;
		color:#7d7878;
		margin:0 0 15px 0;
	}

	/*-- The below differes between export and non --*/

	.custom_header{
		margin: 0 0 10px 0;
	}

	#inline_scratch {
		display:none;
	}

	#main_wrapper{
		max-width:650px;
		margin: 0px auto;
	}

	#inner_wrapper{
		height:100%;
		width:100%;
		padding: 0;
	}

	.footer {
		display:none;
	}
</style>
</head>
<body>
  <div id="inline_scratch">
    <div class="file_menu">
      <a href="#" id="open_scratch" class="files">Open</a>  
      <input type="file" id="fileInput" style="display: none;"/>
      <a href="#" id="save_scratch" class="files">Save</a>   
    </div>
    <div class="scratch_frame">
      <textarea id="scratch_pad" placeholder="This space holds text for use with the prompt interactions found to the right."></textarea>
    </div>
  </div> 
  <div id="main_wrapper">
    <div id="inner_wrapper">
      <!--
        START CUSTOM CONTENT
      -->
      <div class="custom_header"><h1>J.G.G. v. Trump</h1>
<p><i>If you're attending <a href="https://2025.calicon.org/sessions/law-rpg-beginners-session">CALICon2025</a>, I suggest focusing on Distill &amp; Question to get up to speed. However, I've framed things as I would for a weekly class assignment to help provide context. Hopefully what's there will inspire you to explore a bit more after the conference. <a href="../">Back to helper</a></i></p>
<p>
Use one (or more) of the case-aware workflows below to engage with this week's case materials: (1) the <a href="01_Complaint.pdf" target="_blank">complaint</a>; (2) the <a href="02_Motion for TRO.pdf" target="_blank">motion for a temporary restraining order (TRO)</a>; and (3) a partial <a href="03_Emergency hearing without ruling.pdf" target="_blank">transcript</a> of an emergency hearing on the TRO (it doesn't have the judge's ruling). You may also want to "look into the future" by browsing <a href="https://www.courtlistener.com/docket/69741724/jgg-v-trump/?filed_after=&filed_before=&entry_gte=&entry_lte=&order_by=asc" target="_blank">the docket</a>.
</p>
<p>
If you choose Socrates or Moot, you'll want to read through them first, and if you use Distill & Question, you'll need to read them afterward. Every student has to turn in a transcript for at least one case interaction. If you've been assigned as an attorney to this case, you must turn in a transcript of your MOOT. 
</p>
<p>
Additionally, every student must turn in a transcript of their Weekly Reflection.
</p>
<hr></div>
      <!--
        END CUSTOM CONTENT
      -->
      <div id="button_list"></div>
      <div id="transcript" style="display:none;">
        <div id="output_window"></div>
      </div>
      <div id="thinking_box">
        <div id="thinking"></div>
      </div>
      <div id="text_input" style="display:none;">
        <textarea id="user_input"></textarea>
        <button id="send">Send</button>
        <button id="restartButton_companion">Restart</button>
      </div>
      <div id="chat_text_input" style="display:none;">
        <textarea id="chat_user_input"></textarea>
        <button id="chat_send" >Send</button>
        <button id="restartButton_companion_chat">Restart</button>
      </div>
      <div id="continue_gen" style="display:none;">
        <button id='continueButton'>Continue text generation</button>
      </div>
      <a href="#" id="save_transcript">save transcript</a>
      <button id="restartButton">Restart</button>
      <div id="credentials" style="display:none;">
        <table id="credentials_table">
          <tr><td>API&nbsp;Base:&nbsp;</td><td width="100%"><input id="api_base" style="width:100%"></td></tr>
          <tr><td>API&nbsp;Key:&nbsp;</td><td width="100%"><input id="api_key" style="width:100%"></td></tr>
        </table>        
        <button id='credentialsButton'>Update/Save Credentials</button>
      </div>
      <div id="choices" style="display:none;">
        <select id="toPrompt" style="width:100%;margin:5px 0 8px 0;text-align:center;">
          <option value="">Pass output to prompt (choose one)</option>
        </select>
      </div>
    </div>
  </div>
  <div class="footer">
    <button id="config">Templates &amp; Settings</button>
    <button id="scratch">Scratch Pad</button>
    <span style="float:right">
      <button id="about">About</button>
      <button id="feedback">Feedback</button>
    </span>
  </div>
</body>
</html>